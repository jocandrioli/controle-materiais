<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Porta CTO</title>
<!-- Dados atualizados em: 11/02/2026 08:17 | BA filtrado/v√°lido: 1 | BD filtrado/v√°lido: 3 | Total: 4 -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; }
        .table-scroll { max-height: 600px; overflow-y: auto; }
        .table-scroll::-webkit-scrollbar { width: 8px; }
        .table-scroll::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .table-scroll::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 4px; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        const SearchIcon = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>;
        const AlertIcon = () => <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>;
        const FilterIcon = () => <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg>;
        const MapPinIcon = () => <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>;
        const DownloadIcon = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>;
        const NavigationIcon = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg>;

        const DashboardFibra = () => {
            const dadosIniciais = [{"NUMERO_OS": "8-A8A58C39433-1", "STATUS": "PENDENTE", "STATUS_REASON": "TECNICA", "DATA_STATUS": "10/02/2026 14:33:41", "ARMARIO": "RSPAE_G1C03", "STREETNAME": "SEN. TARSO DUTRA-161-BLOCO B 161", "STATEORPROVINCE": "RS", "POSTCODE": 90690140, "CNL": 51000, "NEIGHBORDHOOD": "PETROPOLIS", "CATEGORIZES_TYPE": "INSTALLATION", "SPECIFICATION_TYPE": "INSTALA√á√ÉO", "SPECIFICATION_PRODUCT": "BANDA LARGA AVULSA", "DETAIL": NaN, "DATA_ABERTURA": "04/02/2026 21:05:36", "DATA_VENCIMENTO": "10/02/2026 10:30:00", "TIME_SLOT": "08:30-10:30", "PHYSICALRESOURCESUMMARY": "Switch : PRCTA_VMS02 Vendor : ALCATEL Arm√°rio : G1C03 Porta : 3 Rin : C03-RIN-486 Tecnologia Voz : IMS / GPON Armario: RSPAE_G1C03 Splitter_1n: C03SP43 Fibra_1n: 2 Conexao_1n2n: EXISTENTE Splitter_2n: G1C03SS170 Fibra_2n: 8 Caixa: C03GP172 Cabo: C03 Status: DS", "TELEPHONENUMERIC": NaN, "DESIGNATOR": "PAE-817KYW23WF-013", "CIDADE": "PORTO ALEGRE", "CLUSTER_": "PORTO ALEGRE", "REGIONAL": "SUL", "CUSTOMER_DOCUMENTNUMERIC": NaN, "CUSTOMER_NAME": NaN, "EXECUTEDBYLOGIN": "A0176328", "EXECUTEDBYNAME": null, "NOTDONEREASON": "SPLITTER COM DEFEITO", "PRIORITY": NaN, "SCHEDULEPROFILE": "GPS_1", "CUSTOMER_SEGMENT": "SOHO", "CUSTOMER_TEMPERATURE": 0.0, "CUSTOMER_RANK": "S 1", "SEGMENTACAO": "S 1", "SERVICE_TECHNOLOGY": "SIP FTTH ", "SPECIFICATION_ACRONYM": "IN_BA", "PORTABILITY_STATUS": NaN, "PORTABILITY_START": NaN, "PORTABILITY_END": NaN, "REDESPACHO": 2, "DATEOFSTATUSPORTABILITY": NaN, "DATEOFSTATUSEXECUTION": "10/02/2026 08:25:53", "CONTRACTOR": NaN, "PON": "8-A8A58C39433-1", "RPON": "C00A58DD99", "AGENDADO_NA_VENDA": "NAO", "VELOCIDADEADSL": "Power 700 Mbps", "DATA_AGENDADA": NaN, "DTH_PURO": NaN, "TOTAL_PONTO_ADICIONAL": 0.0, "PACOTE_TV": NaN, "FLAG_GPON": "SIM", "DATA_CANCELAMENTO": NaN, "LOGIN_CANCELAMENTO": NaN, "MOTIVO_DE_CANCELAMENTO": NaN, "OBSERVACAO": NaN, "REDE": "VIVO2", "MICROAREA": NaN, "TELEPHONIC_AREA": NaN, "CENTRAL_OFFICE": NaN, "TECNOLOGIA_ACESSO": "GPON", "DESIGNADOR_TV": null, "DTH_CONECTADO": NaN, "PRODUTOS_ADICIONAR": "Banda Larga (PAE-817KYW23WF-013 FTTH) Home Gateway Unificado ( ) Power 700 Mbps ( )", "PRODUTOS_MODIFICAR": NaN, "PRODUTOS_ATIVO": NaN, "PRODUTOS_DESCONECTAR": NaN, "DATA_CARGA": "11/02/2026 03:25:08", "DATA_LAST_UPDATE_PLWO": "11/02/2026 03:21:15", "TECNOLOGIA_TV": NaN, "LATITUDE": -51.174184399999994, "LONGITUDE": -30.0393349, "CLIENTE_GOAS": "NAO", "MARCACAO_VIA_CHAT": "NAO", "PLATFORM": null, "EXCECAO_ATUAL": NaN, "EXCECAO_ATUAL_ATIVIDADE": NaN, "EXCECAO_ATUAL_GRUPO": NaN, "RECUSA_ANTECIPAR": "N", "DATA_COMPROMISSO": "10/02/2026 10:30:00", "DATA_PRIMEIRA_AGENDA": "07/02/2026 12:00:00", "DESC_GRUPO_RESPONSABILIDADE": NaN, "DESC_CANAL": NaN, "DESC_GRUPO_CANAL": NaN, "FLAG_CANAL_ATENDIMENTO": NaN, "FLAG_VENDE_INSTALA": NaN, "CLIENTES_V_SAV": NaN, "NOM_SISTEMA_ORIGEM": "SIEBEL", "FLAG_MATRIX": 1.0, "FLAG_EVEREST": NaN, "FLAG_MT24H": NaN, "FLAG_PRD_ALTA": NaN, "ID_PRD_ULT_DESC": NaN, "DESIGNADOR_ACESSO": NaN, "FLAG_CASAINTELIGENTE": 0, "PARENT1": "51000_1116102", "PARENT2": "RSPAE_G1C03", "PARENT3": 90690140, "PARENT4": "BKT_PORTO_ALEGRE_TLP", "FLAG_FIBRATODOS": 0.0, "FLAG_ANATEL": NaN, "TIPO": "BA", "SPLITTER_PRIMARIO": "SP43", "SPLITTER_SECUNDARIO": "SS2", "MAX_SECUNDARIOS": 4, "CAIXA_CTO_GP": "C03GP172", "TIPO_CAIXA": "GP (Predial)", "FORMATO_DETECTADO": "SPLITTER_1N_2N_CALC", "COD_SS": NaN, "CITY": NaN, "FABRICA": NaN, "CONTEXTO_SIEBEL": NaN, "TOTAL_REPETIDO_30D_PL": NaN, "TECNICO_CHECKLIST": NaN, "REPETIDO_PRODUTO_30D": NaN, "REGISTRADO_CHECKLIST": NaN, "PHYSICAL_LINK_MEDIA_TYPE": NaN, "FLAG_RECENTE": NaN, "EXECUTOR_BA": NaN, "TEC_ANTERIOR": NaN, "PRIMEIRO_AGENDAMENTO": NaN, "CABO_PRIMARIO": NaN, "PAR_PRIMARIO": NaN, "CABO_SECUNDARIO": NaN, "PAR_SECUNDARIO": NaN, "LATERAL_PRIMARIO": NaN, "LATERAL": NaN, "NUMERO_CAIXA": NaN, "NOME_MSAN": NaN, "NP": NaN, "ID_FIBRA": NaN, "OLT": NaN, "OLT_PORTA": NaN, "OLT_SLOT": NaN, "SPLITTER_FIBRA_L2": NaN, "ORIGEM_CONTATO": NaN, "ABERTURA_TIPO2_SIEBEL": NaN, "IND_CRITICOS": NaN, "IND_DISPONIBILIDADE_FIBRA": null, "SAS_BUSINESSID": NaN, "SAS_STATUSREASON": NaN, "SASEVEN_CODE": NaN, "SASEVEN_VIVO1_ID": NaN, "SASEVEN_DATA_INICIO": NaN, "SASEVEN_FLAG_ATIVO": NaN, "SASEVEN_DATA_PREVISAO": NaN, "SASEVEN_DATA_FECHAMENTO": NaN, "SASEVEN_LEVEL": NaN, "SASEVEN_CREATOR": NaN, "SASCAUSA_NOME": NaN, "XA_FAULT_REASON": NaN, "XA_OPERATOR_ID": NaN, "XA_API_CANCEL_REASON": NaN, "FLAG_ICMCOE": NaN, "AURA_CASO": NaN, "AURA_DAT_ENVIO": NaN, "AURA_DAT_CONF": NaN, "AURA_RETORNO": NaN, "IFI": NaN, "IFI_GERADOR": NaN, "IRR": NaN, "IRR_GERADOR": NaN, "FL_COBERTURA": NaN, "FL_DISPONIBILIDADE": NaN, "FL_22K": NaN, "ID_MASSIVA": NaN, "ID_ORIGEM_MASSIVA": NaN, "STATUS_MASSIVA": NaN, "STATUS_CERT_CE": NaN, "STATUS_CERTIFICACAO_QUALIDADE": NaN, "V_SEM_TESTE": NaN, "STATUS_AURA": NaN, "RESPOSTA_AURA": NaN, "V_PRAZO_ENCERRAMENTO_CO": NaN, "V_PRAZO_CERTIFICACAO_GERAL": NaN, "AGING_ENVIO_COE_ENCERRAR": NaN, "AGING_FIM_DESASSOCIACAO": NaN, "STATUS_CIRE": NaN, "RESULTADO_TESTE_AUTH_TI": NaN, "RESULTADO_TESTE_SYNC_TI": NaN, "DATA_PROCESSAMENTO_REPARO": NaN, "DATA_ENCOUCANC_MASSIVA": NaN, "DATA_ENVIO_AURA": NaN, "DATA_RESPOSTA_AURA": NaN, "DATA_STATUS_CIRE": NaN, "DATA_DISPARO_TESTE_TI": NaN, "DATA_COLETA_TESTE_TI": NaN, "DATA_ENVIO_COE_ENCERRAR": NaN, "DATA_DESASSOCIACAO": NaN, "FLAG_FOI_DESASSOCIADO": NaN, "EMPRESA_REDE": "TLP", "ACESSO_REDE": "GPON", "AREA_REDE": "05 - PAE", "CLUSTER_REDE": "PORTO ALEGRE", "CIDADE_REDE": "PORTO ALEGRE", "SUPERVISOR_VIVO": "MARIO FERNANDO"}, {"NUMERO_OS": "8-7KZVS8NQ", "STATUS": "PENDENTE", "STATUS_REASON": "TECNICA", "DATA_STATUS": "10/02/2026 14:43:02", "ARMARIO": "RSPAE_G1M56", "STREETNAME": ". ASSIS BRASIL 6493", "STATEORPROVINCE": "RS", "POSTCODE": 91140001, "CNL": 51000, "NEIGHBORDHOOD": "SARANDI", "CATEGORIZES_TYPE": "TROUBLETICKET", "SPECIFICATION_TYPE": "DEFEITO", "SPECIFICATION_PRODUCT": "BANDA", "DETAIL": "NAVEG - N√ÉO NAVEGA", "DATA_ABERTURA": "07/02/2026 09:53:39", "DATA_VENCIMENTO": "10/02/2026 16:00:00", "TIME_SLOT": "14:00-16:00", "PHYSICALRESOURCESUMMARY": "Armario: RSPAE_G1M56 Splitter_1n: M56SP593 Fibra_1n: 2 Conexao_1n2n: EXISTENTE Splitter_2n: M56SP593SS2 Fibra_2n: 1 Caixa: M56G02370 Cabo: M56 Status: OC, armario: RSPAE_G1M56, velocidade UP: 256, velocidade DOWN: 512, shelf:  , node Address: M56-SP593-963, secundario:  , porta: 00963, rin: , shasta: PAE180111, switch: PRCTA_VMS02, vendor name: ALCATEL, tecnologia acesso: GPON, Rede: DESCENTRALIZADOEnd_SP_1n: FRANCISCO SILVEIRA BITENCOURT  End_SP_2n: ASSIS BRASIL  ", "TELEPHONENUMERIC": NaN, "DESIGNATOR": "PAE-817JJXFEG2-013", "CIDADE": "PORTO ALEGRE", "CLUSTER_": "PORTO ALEGRE", "REGIONAL": "SUL", "CUSTOMER_DOCUMENTNUMERIC": NaN, "CUSTOMER_NAME": NaN, "EXECUTEDBYLOGIN": "81049555", "EXECUTEDBYNAME": null, "NOTDONEREASON": "PORTA CTO COM DEFEITO", "PRIORITY": NaN, "SCHEDULEPROFILE": "GPS_1", "CUSTOMER_SEGMENT": "SOHO", "CUSTOMER_TEMPERATURE": NaN, "CUSTOMER_RANK": "S 8", "SEGMENTACAO": "SOHO", "SERVICE_TECHNOLOGY": "SIP ACESSO FTTH ", "SPECIFICATION_ACRONYM": NaN, "PORTABILITY_STATUS": NaN, "PORTABILITY_START": NaN, "PORTABILITY_END": NaN, "REDESPACHO": 2, "DATEOFSTATUSPORTABILITY": NaN, "DATEOFSTATUSEXECUTION": NaN, "CONTRACTOR": NaN, "PON": NaN, "RPON": NaN, "AGENDADO_NA_VENDA": NaN, "VELOCIDADEADSL": "Power 500 Mbps", "DATA_AGENDADA": NaN, "DTH_PURO": NaN, "TOTAL_PONTO_ADICIONAL": NaN, "PACOTE_TV": NaN, "FLAG_GPON": NaN, "DATA_CANCELAMENTO": NaN, "LOGIN_CANCELAMENTO": NaN, "MOTIVO_DE_CANCELAMENTO": NaN, "OBSERVACAO": NaN, "REDE": "VIVO2", "MICROAREA": NaN, "TELEPHONIC_AREA": NaN, "CENTRAL_OFFICE": NaN, "TECNOLOGIA_ACESSO": NaN, "DESIGNADOR_TV": null, "DTH_CONECTADO": NaN, "PRODUTOS_ADICIONAR": NaN, "PRODUTOS_MODIFICAR": NaN, "PRODUTOS_ATIVO": NaN, "PRODUTOS_DESCONECTAR": NaN, "DATA_CARGA": "11/02/2026 03:29:32", "DATA_LAST_UPDATE_PLWO": "11/02/2026 03:21:15", "TECNOLOGIA_TV": NaN, "LATITUDE": -51.1261918, "LONGITUDE": -29.9918342, "CLIENTE_GOAS": "NAO", "MARCACAO_VIA_CHAT": null, "PLATFORM": null, "EXCECAO_ATUAL": NaN, "EXCECAO_ATUAL_ATIVIDADE": NaN, "EXCECAO_ATUAL_GRUPO": NaN, "RECUSA_ANTECIPAR": NaN, "DATA_COMPROMISSO": NaN, "DATA_PRIMEIRA_AGENDA": NaN, "DESC_GRUPO_RESPONSABILIDADE": NaN, "DESC_CANAL": NaN, "DESC_GRUPO_CANAL": NaN, "FLAG_CANAL_ATENDIMENTO": NaN, "FLAG_VENDE_INSTALA": NaN, "CLIENTES_V_SAV": NaN, "NOM_SISTEMA_ORIGEM": "SIEBEL", "FLAG_MATRIX": NaN, "FLAG_EVEREST": NaN, "FLAG_MT24H": NaN, "FLAG_PRD_ALTA": NaN, "ID_PRD_ULT_DESC": NaN, "DESIGNADOR_ACESSO": NaN, "FLAG_CASAINTELIGENTE": 0, "PARENT1": "51000_050130", "PARENT2": "RSPAE_G1M56", "PARENT3": 91140001, "PARENT4": "BKT_PORTO_ALEGRE_TLP", "FLAG_FIBRATODOS": NaN, "FLAG_ANATEL": NaN, "TIPO": "BD", "SPLITTER_PRIMARIO": "SP593", "SPLITTER_SECUNDARIO": "SS2", "MAX_SECUNDARIOS": 8, "CAIXA_CTO_GP": "M56G02370", "TIPO_CAIXA": "G0 (CTO Poste)", "FORMATO_DETECTADO": "SPLITTER_1N_2N_COMPLETO", "COD_SS": "8-7KZVS8NQ", "CITY": "PORTO ALEGRE", "FABRICA": " ", "CONTEXTO_SIEBEL": "C00A438268", "TOTAL_REPETIDO_30D_PL": 0.0, "TECNICO_CHECKLIST": "NAO", "REPETIDO_PRODUTO_30D": 0.0, "REGISTRADO_CHECKLIST": "NAO", "PHYSICAL_LINK_MEDIA_TYPE": "GPON", "FLAG_RECENTE": "N", "EXECUTOR_BA": NaN, "TEC_ANTERIOR": NaN, "PRIMEIRO_AGENDAMENTO": "2026-02-09 10:30:00", "CABO_PRIMARIO": NaN, "PAR_PRIMARIO": NaN, "CABO_SECUNDARIO": NaN, "PAR_SECUNDARIO": NaN, "LATERAL_PRIMARIO": NaN, "LATERAL": NaN, "NUMERO_CAIXA": NaN, "NOME_MSAN": NaN, "NP": NaN, "ID_FIBRA": NaN, "OLT": NaN, "OLT_PORTA": NaN, "OLT_SLOT": NaN, "SPLITTER_FIBRA_L2": NaN, "ORIGEM_CONTATO": NaN, "ABERTURA_TIPO2_SIEBEL": NaN, "IND_CRITICOS": 0.0, "IND_DISPONIBILIDADE_FIBRA": false, "SAS_BUSINESSID": NaN, "SAS_STATUSREASON": NaN, "SASEVEN_CODE": NaN, "SASEVEN_VIVO1_ID": NaN, "SASEVEN_DATA_INICIO": NaN, "SASEVEN_FLAG_ATIVO": NaN, "SASEVEN_DATA_PREVISAO": NaN, "SASEVEN_DATA_FECHAMENTO": NaN, "SASEVEN_LEVEL": NaN, "SASEVEN_CREATOR": NaN, "SASCAUSA_NOME": NaN, "XA_FAULT_REASON": NaN, "XA_OPERATOR_ID": NaN, "XA_API_CANCEL_REASON": NaN, "FLAG_ICMCOE": NaN, "AURA_CASO": NaN, "AURA_DAT_ENVIO": NaN, "AURA_DAT_CONF": NaN, "AURA_RETORNO": NaN, "IFI": 0.0, "IFI_GERADOR": NaN, "IRR": 0.0, "IRR_GERADOR": NaN, "FL_COBERTURA": NaN, "FL_DISPONIBILIDADE": NaN, "FL_22K": NaN, "ID_MASSIVA": NaN, "ID_ORIGEM_MASSIVA": NaN, "STATUS_MASSIVA": NaN, "STATUS_CERT_CE": NaN, "STATUS_CERTIFICACAO_QUALIDADE": NaN, "V_SEM_TESTE": NaN, "STATUS_AURA": NaN, "RESPOSTA_AURA": NaN, "V_PRAZO_ENCERRAMENTO_CO": NaN, "V_PRAZO_CERTIFICACAO_GERAL": NaN, "AGING_ENVIO_COE_ENCERRAR": NaN, "AGING_FIM_DESASSOCIACAO": NaN, "STATUS_CIRE": NaN, "RESULTADO_TESTE_AUTH_TI": NaN, "RESULTADO_TESTE_SYNC_TI": NaN, "DATA_PROCESSAMENTO_REPARO": NaN, "DATA_ENCOUCANC_MASSIVA": NaN, "DATA_ENVIO_AURA": NaN, "DATA_RESPOSTA_AURA": NaN, "DATA_STATUS_CIRE": NaN, "DATA_DISPARO_TESTE_TI": NaN, "DATA_COLETA_TESTE_TI": NaN, "DATA_ENVIO_COE_ENCERRAR": NaN, "DATA_DESASSOCIACAO": NaN, "FLAG_FOI_DESASSOCIADO": NaN, "EMPRESA_REDE": "TLP", "ACESSO_REDE": "GPON", "AREA_REDE": "09 - PAE", "CLUSTER_REDE": "PORTO ALEGRE", "CIDADE_REDE": "PORTO ALEGRE", "SUPERVISOR_VIVO": "RODRIGO DUARTE"}, {"NUMERO_OS": "8-7L01IOEF", "STATUS": "PENDENTE", "STATUS_REASON": "TECNICA", "DATA_STATUS": "09/02/2026 09:47:14", "ARMARIO": "RSPAE_G1I40", "STREETNAME": ". CARVALHO MONTEIRO 247", "STATEORPROVINCE": "RS", "POSTCODE": 90470100, "CNL": 51000, "NEIGHBORDHOOD": "PETROPOLIS", "CATEGORIZES_TYPE": "TROUBLETICKET", "SPECIFICATION_TYPE": "DEFEITO", "SPECIFICATION_PRODUCT": "BANDA", "DETAIL": "VELOCIDADE", "DATA_ABERTURA": "07/02/2026 16:52:38", "DATA_VENCIMENTO": "09/02/2026 10:30:00", "TIME_SLOT": "08:30-10:30", "PHYSICALRESOURCESUMMARY": "Armario: RSPAE_G1I40 Splitter_1n: I40SP218 Fibra_1n: 2 Conexao_1n2n: EXISTENTE Splitter_2n: I40SP218SS2 Fibra_2n: 7 Caixa: I40GP1738 Cabo: I40 Status: OC, armario: RSPAE_G1I40, velocidade UP: 204,8, velocidade DOWN: 409,6, shelf:  , node Address: I40-SP218-2609, secundario:  , porta: 02609, rin: , shasta: PAE130111, switch: PRCTA_VMS02, vendor name: HUAWEI, tecnologia acesso: GPON, Rede: DESCENTRALIZADOEnd_SP_1n: REGENTE  End_SP_2n: CARVALHO MONTEIRO  ", "TELEPHONENUMERIC": NaN, "DESIGNATOR": "PAE-817IOYBTI1-013", "CIDADE": "PORTO ALEGRE", "CLUSTER_": "PORTO ALEGRE", "REGIONAL": "SUL", "CUSTOMER_DOCUMENTNUMERIC": NaN, "CUSTOMER_NAME": NaN, "EXECUTEDBYLOGIN": "80967405", "EXECUTEDBYNAME": null, "NOTDONEREASON": "PORTA CTO COM DEFEITO", "PRIORITY": NaN, "SCHEDULEPROFILE": "GPS_1", "CUSTOMER_SEGMENT": "SOHO", "CUSTOMER_TEMPERATURE": NaN, "CUSTOMER_RANK": "S 8", "SEGMENTACAO": "SOHO", "SERVICE_TECHNOLOGY": "SIP ACESSO FTTH ", "SPECIFICATION_ACRONYM": NaN, "PORTABILITY_STATUS": NaN, "PORTABILITY_START": NaN, "PORTABILITY_END": NaN, "REDESPACHO": 1, "DATEOFSTATUSPORTABILITY": NaN, "DATEOFSTATUSEXECUTION": NaN, "CONTRACTOR": NaN, "PON": NaN, "RPON": NaN, "AGENDADO_NA_VENDA": NaN, "VELOCIDADEADSL": "Power 400 Mbps", "DATA_AGENDADA": NaN, "DTH_PURO": NaN, "TOTAL_PONTO_ADICIONAL": NaN, "PACOTE_TV": NaN, "FLAG_GPON": NaN, "DATA_CANCELAMENTO": NaN, "LOGIN_CANCELAMENTO": NaN, "MOTIVO_DE_CANCELAMENTO": NaN, "OBSERVACAO": NaN, "REDE": "VIVO2", "MICROAREA": NaN, "TELEPHONIC_AREA": NaN, "CENTRAL_OFFICE": NaN, "TECNOLOGIA_ACESSO": NaN, "DESIGNADOR_TV": null, "DTH_CONECTADO": NaN, "PRODUTOS_ADICIONAR": NaN, "PRODUTOS_MODIFICAR": NaN, "PRODUTOS_ATIVO": NaN, "PRODUTOS_DESCONECTAR": NaN, "DATA_CARGA": "11/02/2026 03:29:32", "DATA_LAST_UPDATE_PLWO": "11/02/2026 03:21:15", "TECNOLOGIA_TV": NaN, "LATITUDE": -51.180384, "LONGITUDE": -30.0303362, "CLIENTE_GOAS": "NAO", "MARCACAO_VIA_CHAT": null, "PLATFORM": null, "EXCECAO_ATUAL": NaN, "EXCECAO_ATUAL_ATIVIDADE": NaN, "EXCECAO_ATUAL_GRUPO": NaN, "RECUSA_ANTECIPAR": NaN, "DATA_COMPROMISSO": NaN, "DATA_PRIMEIRA_AGENDA": NaN, "DESC_GRUPO_RESPONSABILIDADE": NaN, "DESC_CANAL": NaN, "DESC_GRUPO_CANAL": NaN, "FLAG_CANAL_ATENDIMENTO": NaN, "FLAG_VENDE_INSTALA": NaN, "CLIENTES_V_SAV": NaN, "NOM_SISTEMA_ORIGEM": "SIEBEL", "FLAG_MATRIX": NaN, "FLAG_EVEREST": NaN, "FLAG_MT24H": NaN, "FLAG_PRD_ALTA": NaN, "ID_PRD_ULT_DESC": NaN, "DESIGNADOR_ACESSO": NaN, "FLAG_CASAINTELIGENTE": 0, "PARENT1": "51000_007781", "PARENT2": "RSPAE_G1I40", "PARENT3": 90470100, "PARENT4": "BKT_PORTO_ALEGRE_TLP", "FLAG_FIBRATODOS": NaN, "FLAG_ANATEL": NaN, "TIPO": "BD", "SPLITTER_PRIMARIO": "SP218", "SPLITTER_SECUNDARIO": "SS2", "MAX_SECUNDARIOS": 8, "CAIXA_CTO_GP": "I40GP1738", "TIPO_CAIXA": "GP (Predial)", "FORMATO_DETECTADO": "SPLITTER_1N_2N_COMPLETO", "COD_SS": "8-7L01IOEF", "CITY": "PORTO ALEGRE", "FABRICA": " ", "CONTEXTO_SIEBEL": "C00A359411", "TOTAL_REPETIDO_30D_PL": 0.0, "TECNICO_CHECKLIST": "NAO", "REPETIDO_PRODUTO_30D": 0.0, "REGISTRADO_CHECKLIST": "NAO", "PHYSICAL_LINK_MEDIA_TYPE": "GPON", "FLAG_RECENTE": "N", "EXECUTOR_BA": NaN, "TEC_ANTERIOR": NaN, "PRIMEIRO_AGENDAMENTO": "2026-02-09 10:30:00", "CABO_PRIMARIO": NaN, "PAR_PRIMARIO": NaN, "CABO_SECUNDARIO": NaN, "PAR_SECUNDARIO": NaN, "LATERAL_PRIMARIO": NaN, "LATERAL": NaN, "NUMERO_CAIXA": NaN, "NOME_MSAN": NaN, "NP": NaN, "ID_FIBRA": NaN, "OLT": NaN, "OLT_PORTA": NaN, "OLT_SLOT": NaN, "SPLITTER_FIBRA_L2": NaN, "ORIGEM_CONTATO": NaN, "ABERTURA_TIPO2_SIEBEL": NaN, "IND_CRITICOS": 0.0, "IND_DISPONIBILIDADE_FIBRA": false, "SAS_BUSINESSID": NaN, "SAS_STATUSREASON": NaN, "SASEVEN_CODE": NaN, "SASEVEN_VIVO1_ID": NaN, "SASEVEN_DATA_INICIO": NaN, "SASEVEN_FLAG_ATIVO": NaN, "SASEVEN_DATA_PREVISAO": NaN, "SASEVEN_DATA_FECHAMENTO": NaN, "SASEVEN_LEVEL": NaN, "SASEVEN_CREATOR": NaN, "SASCAUSA_NOME": NaN, "XA_FAULT_REASON": NaN, "XA_OPERATOR_ID": NaN, "XA_API_CANCEL_REASON": NaN, "FLAG_ICMCOE": NaN, "AURA_CASO": NaN, "AURA_DAT_ENVIO": NaN, "AURA_DAT_CONF": NaN, "AURA_RETORNO": NaN, "IFI": 0.0, "IFI_GERADOR": NaN, "IRR": 0.0, "IRR_GERADOR": NaN, "FL_COBERTURA": NaN, "FL_DISPONIBILIDADE": NaN, "FL_22K": NaN, "ID_MASSIVA": NaN, "ID_ORIGEM_MASSIVA": NaN, "STATUS_MASSIVA": NaN, "STATUS_CERT_CE": NaN, "STATUS_CERTIFICACAO_QUALIDADE": NaN, "V_SEM_TESTE": NaN, "STATUS_AURA": NaN, "RESPOSTA_AURA": NaN, "V_PRAZO_ENCERRAMENTO_CO": NaN, "V_PRAZO_CERTIFICACAO_GERAL": NaN, "AGING_ENVIO_COE_ENCERRAR": NaN, "AGING_FIM_DESASSOCIACAO": NaN, "STATUS_CIRE": NaN, "RESULTADO_TESTE_AUTH_TI": NaN, "RESULTADO_TESTE_SYNC_TI": NaN, "DATA_PROCESSAMENTO_REPARO": NaN, "DATA_ENCOUCANC_MASSIVA": NaN, "DATA_ENVIO_AURA": NaN, "DATA_RESPOSTA_AURA": NaN, "DATA_STATUS_CIRE": NaN, "DATA_DISPARO_TESTE_TI": NaN, "DATA_COLETA_TESTE_TI": NaN, "DATA_ENVIO_COE_ENCERRAR": NaN, "DATA_DESASSOCIACAO": NaN, "FLAG_FOI_DESASSOCIADO": NaN, "EMPRESA_REDE": "TLP", "ACESSO_REDE": "GPON", "AREA_REDE": "05 - PAE", "CLUSTER_REDE": "PORTO ALEGRE", "CIDADE_REDE": "PORTO ALEGRE", "SUPERVISOR_VIVO": "MARIO FERNANDO"}, {"NUMERO_OS": "8-7L0W2M6W", "STATUS": "PENDENTE", "STATUS_REASON": "TECNICA", "DATA_STATUS": "10/02/2026 12:01:06", "ARMARIO": "RSPAE_G1N42", "STREETNAME": ". GETULIO VARGAS 1603", "STATEORPROVINCE": "RS", "POSTCODE": 90150005, "CNL": 51000, "NEIGHBORDHOOD": "MENINO DEUS", "CATEGORIZES_TYPE": "TROUBLETICKET", "SPECIFICATION_TYPE": "DEFEITO", "SPECIFICATION_PRODUCT": "BANDA", "DETAIL": "MODEM COMODATO", "DATA_ABERTURA": "10/02/2026 08:24:33", "DATA_VENCIMENTO": "10/02/2026 12:30:00", "TIME_SLOT": "10:30-12:30", "PHYSICALRESOURCESUMMARY": "Armario: RSPAE_G1N42 Splitter_1n: N42SP319 Fibra_1n: 1 Conexao_1n2n: EXISTENTE Splitter_2n: N42SP319SS1 Fibra_2n: 8 Caixa: N42G02546 Cabo: N42 Status: OC, armario: RSPAE_G1N42, velocidade UP: 204,8, velocidade DOWN: 409,6, shelf:  , node Address: N42-SP319-2305, secundario:  , porta: 02305, rin: , shasta: PAE50111, switch: PRCTA_VMS02, vendor name: HUAWEI, tecnologia acesso: GPON, Rede: DESCENTRALIZADOEnd_SP_1n: BARBEDO  End_SP_2n: GETULIO VARGAS  ", "TELEPHONENUMERIC": NaN, "DESIGNATOR": "PAE-8173LF63AD-013", "CIDADE": "PORTO ALEGRE", "CLUSTER_": "PORTO ALEGRE", "REGIONAL": "SUL", "CUSTOMER_DOCUMENTNUMERIC": NaN, "CUSTOMER_NAME": NaN, "EXECUTEDBYLOGIN": "80470728", "EXECUTEDBYNAME": null, "NOTDONEREASON": "PORTA CTO COM DEFEITO", "PRIORITY": NaN, "SCHEDULEPROFILE": "GPS_1", "CUSTOMER_SEGMENT": "SOHO", "CUSTOMER_TEMPERATURE": NaN, "CUSTOMER_RANK": "S 8", "SEGMENTACAO": "SOHO", "SERVICE_TECHNOLOGY": "SIP ACESSO FTTH ", "SPECIFICATION_ACRONYM": NaN, "PORTABILITY_STATUS": NaN, "PORTABILITY_START": NaN, "PORTABILITY_END": NaN, "REDESPACHO": 1, "DATEOFSTATUSPORTABILITY": NaN, "DATEOFSTATUSEXECUTION": NaN, "CONTRACTOR": NaN, "PON": NaN, "RPON": NaN, "AGENDADO_NA_VENDA": NaN, "VELOCIDADEADSL": "Power 400 Mbps", "DATA_AGENDADA": NaN, "DTH_PURO": NaN, "TOTAL_PONTO_ADICIONAL": NaN, "PACOTE_TV": NaN, "FLAG_GPON": NaN, "DATA_CANCELAMENTO": NaN, "LOGIN_CANCELAMENTO": NaN, "MOTIVO_DE_CANCELAMENTO": NaN, "OBSERVACAO": NaN, "REDE": "VIVO2", "MICROAREA": NaN, "TELEPHONIC_AREA": NaN, "CENTRAL_OFFICE": NaN, "TECNOLOGIA_ACESSO": NaN, "DESIGNADOR_TV": null, "DTH_CONECTADO": NaN, "PRODUTOS_ADICIONAR": NaN, "PRODUTOS_MODIFICAR": NaN, "PRODUTOS_ATIVO": NaN, "PRODUTOS_DESCONECTAR": NaN, "DATA_CARGA": "11/02/2026 03:29:32", "DATA_LAST_UPDATE_PLWO": "11/02/2026 03:21:15", "TECNOLOGIA_TV": NaN, "LATITUDE": -51.2247935, "LONGITUDE": -30.0603341, "CLIENTE_GOAS": "NAO", "MARCACAO_VIA_CHAT": null, "PLATFORM": null, "EXCECAO_ATUAL": NaN, "EXCECAO_ATUAL_ATIVIDADE": NaN, "EXCECAO_ATUAL_GRUPO": NaN, "RECUSA_ANTECIPAR": NaN, "DATA_COMPROMISSO": NaN, "DATA_PRIMEIRA_AGENDA": NaN, "DESC_GRUPO_RESPONSABILIDADE": NaN, "DESC_CANAL": NaN, "DESC_GRUPO_CANAL": NaN, "FLAG_CANAL_ATENDIMENTO": NaN, "FLAG_VENDE_INSTALA": NaN, "CLIENTES_V_SAV": NaN, "NOM_SISTEMA_ORIGEM": "SIEBEL", "FLAG_MATRIX": NaN, "FLAG_EVEREST": NaN, "FLAG_MT24H": NaN, "FLAG_PRD_ALTA": NaN, "ID_PRD_ULT_DESC": NaN, "DESIGNADOR_ACESSO": NaN, "FLAG_CASAINTELIGENTE": 0, "PARENT1": "51000_015040", "PARENT2": "RSPAE_G1N42", "PARENT3": 90150005, "PARENT4": NaN, "FLAG_FIBRATODOS": NaN, "FLAG_ANATEL": NaN, "TIPO": "BD", "SPLITTER_PRIMARIO": "SP319", "SPLITTER_SECUNDARIO": "SS1", "MAX_SECUNDARIOS": 8, "CAIXA_CTO_GP": "N42G02546", "TIPO_CAIXA": "G0 (CTO Poste)", "FORMATO_DETECTADO": "SPLITTER_1N_2N_COMPLETO", "COD_SS": "8-7L0W2M6W", "CITY": "PORTO ALEGRE", "FABRICA": " ", "CONTEXTO_SIEBEL": "C009B56AB5", "TOTAL_REPETIDO_30D_PL": 0.0, "TECNICO_CHECKLIST": "NAO", "REPETIDO_PRODUTO_30D": 0.0, "REGISTRADO_CHECKLIST": "NAO", "PHYSICAL_LINK_MEDIA_TYPE": "GPON", "FLAG_RECENTE": "N", "EXECUTOR_BA": NaN, "TEC_ANTERIOR": NaN, "PRIMEIRO_AGENDAMENTO": "2026-02-10 12:30:00", "CABO_PRIMARIO": NaN, "PAR_PRIMARIO": NaN, "CABO_SECUNDARIO": NaN, "PAR_SECUNDARIO": NaN, "LATERAL_PRIMARIO": NaN, "LATERAL": NaN, "NUMERO_CAIXA": NaN, "NOME_MSAN": NaN, "NP": NaN, "ID_FIBRA": NaN, "OLT": NaN, "OLT_PORTA": NaN, "OLT_SLOT": NaN, "SPLITTER_FIBRA_L2": NaN, "ORIGEM_CONTATO": NaN, "ABERTURA_TIPO2_SIEBEL": NaN, "IND_CRITICOS": 0.0, "IND_DISPONIBILIDADE_FIBRA": false, "SAS_BUSINESSID": NaN, "SAS_STATUSREASON": NaN, "SASEVEN_CODE": NaN, "SASEVEN_VIVO1_ID": NaN, "SASEVEN_DATA_INICIO": NaN, "SASEVEN_FLAG_ATIVO": NaN, "SASEVEN_DATA_PREVISAO": NaN, "SASEVEN_DATA_FECHAMENTO": NaN, "SASEVEN_LEVEL": NaN, "SASEVEN_CREATOR": NaN, "SASCAUSA_NOME": NaN, "XA_FAULT_REASON": NaN, "XA_OPERATOR_ID": NaN, "XA_API_CANCEL_REASON": NaN, "FLAG_ICMCOE": NaN, "AURA_CASO": NaN, "AURA_DAT_ENVIO": NaN, "AURA_DAT_CONF": NaN, "AURA_RETORNO": NaN, "IFI": 0.0, "IFI_GERADOR": NaN, "IRR": 0.0, "IRR_GERADOR": NaN, "FL_COBERTURA": NaN, "FL_DISPONIBILIDADE": NaN, "FL_22K": NaN, "ID_MASSIVA": NaN, "ID_ORIGEM_MASSIVA": NaN, "STATUS_MASSIVA": NaN, "STATUS_CERT_CE": NaN, "STATUS_CERTIFICACAO_QUALIDADE": NaN, "V_SEM_TESTE": NaN, "STATUS_AURA": NaN, "RESPOSTA_AURA": NaN, "V_PRAZO_ENCERRAMENTO_CO": NaN, "V_PRAZO_CERTIFICACAO_GERAL": NaN, "AGING_ENVIO_COE_ENCERRAR": NaN, "AGING_FIM_DESASSOCIACAO": NaN, "STATUS_CIRE": NaN, "RESULTADO_TESTE_AUTH_TI": NaN, "RESULTADO_TESTE_SYNC_TI": NaN, "DATA_PROCESSAMENTO_REPARO": NaN, "DATA_ENCOUCANC_MASSIVA": NaN, "DATA_ENVIO_AURA": NaN, "DATA_RESPOSTA_AURA": NaN, "DATA_STATUS_CIRE": NaN, "DATA_DISPARO_TESTE_TI": NaN, "DATA_COLETA_TESTE_TI": NaN, "DATA_ENVIO_COE_ENCERRAR": NaN, "DATA_DESASSOCIACAO": NaN, "FLAG_FOI_DESASSOCIADO": NaN, "EMPRESA_REDE": "VIVO", "ACESSO_REDE": "GPON", "AREA_REDE": "02 - PAE", "CLUSTER_REDE": "PORTO ALEGRE", "CIDADE_REDE": "PORTO ALEGRE", "SUPERVISOR_VIVO": "ALEXANDRE ILHA"}];
            
            const [servicos] = useState(dadosIniciais);
            const [filtrados, setFiltrados] = useState(dadosIniciais);
            const [filtroTexto, setFiltroTexto] = useState('');
            const [filtroTipo, setFiltroTipo] = useState('todos');
            const [filtroCidade, setFiltroCidade] = useState('todos');
            const [filtroTipoCaixa, setFiltroTipoCaixa] = useState('todos');
            const [filtroEmpresa, setFiltroEmpresa] = useState('todos');
            const [selectedOS, setSelectedOS] = useState(null);
            const [agora, setAgora] = useState(Date.now());

            useEffect(() => {
                const timer = setInterval(() => setAgora(Date.now()), 60000);
                return () => clearInterval(timer);
            }, []);


            useEffect(() => {
                aplicarFiltros();
            }, [filtroTexto, filtroTipo, filtroCidade, filtroTipoCaixa, filtroEmpresa]);

            const aplicarFiltros = () => {
                let resultado = [...servicos];
                
                if (filtroTexto) {
                    const termo = filtroTexto.toLowerCase();
                    resultado = resultado.filter(s => 
                        (s.NUMERO_OS && s.NUMERO_OS.toLowerCase().includes(termo)) ||
                        (s.COD_SS && s.COD_SS.toLowerCase().includes(termo)) ||
                        (s.ARMARIO && s.ARMARIO.toLowerCase().includes(termo)) ||
                        (s.SPLITTER_PRIMARIO && s.SPLITTER_PRIMARIO.toLowerCase().includes(termo)) ||
                        (s.SPLITTER_SECUNDARIO && s.SPLITTER_SECUNDARIO.toLowerCase().includes(termo)) ||
                        (s.CAIXA_CTO_GP && s.CAIXA_CTO_GP.toLowerCase().includes(termo))
                    );
                }
                
                if (filtroTipo !== 'todos') {
                    resultado = resultado.filter(s => s.TIPO === filtroTipo);
                }

                if (filtroCidade !== 'todos') {
                    resultado = resultado.filter(s => (s.CIDADE || s.CITY) === filtroCidade);
                }

                if (filtroTipoCaixa !== 'todos') {
                    resultado = resultado.filter(s => s.TIPO_CAIXA === filtroTipoCaixa);
                }
                

                if (filtroEmpresa !== 'todos') {
                    if (filtroEmpresa === 'sem') {
                        resultado = resultado.filter(s => !s.EMPRESA_REDE);
                    } else {
                        resultado = resultado.filter(s => (s.EMPRESA_REDE || '').toUpperCase() === filtroEmpresa);
                    }
                }

                // Organizar: prioriza SLA vencido e menor tempo restante
                resultado.sort((a, b) => {
                    const ra = getSlaRemainingMs(a);
                    const rb = getSlaRemainingMs(b);
                    const va = ra == null ? Number.POSITIVE_INFINITY : ra;
                    const vb = rb == null ? Number.POSITIVE_INFINITY : rb;
                    return va - vb;
                });

                setFiltrados(resultado);
            };

            // ===== Tempo de Vida / Tempo na Pend√™ncia / SLA =====
            // Datas aceitas: "DD/MM/AAAA HH:MM", "DD/MM/AAAA HH:MM:SS", "AAAA-MM-DD HH:MM:SS"
            const parseDateTimeBR = (value) => {
                if (!value) return null;
                const s0 = String(value).trim();
                if (!s0 || s0.toUpperCase() === 'N/E') return null;
                const s = s0.replace('T', ' ');

                // ISO-like: 2026-01-30 12:30:00
                if (/^\d{4}-\d{2}-\d{2}/.test(s)) {
                    const [datePart, timePart = '00:00:00'] = s.split(' ');
                    const [y, m, d] = datePart.split('-').map(Number);
                    const [hh = 0, mm = 0, ss = 0] = timePart.split(':').map(Number);
                    return new Date(y, m - 1, d, hh, mm, ss);
                }

                // BR: 30/01/2026 12:30 (ou com segundos)
                if (/^\d{2}\/\d{2}\/\d{4}/.test(s)) {
                    const [datePart, timePart = '00:00:00'] = s.split(' ');
                    const [d, m, y] = datePart.split('/').map(Number);
                    const [hh = 0, mm = 0, ss = 0] = timePart.split(':').map(Number);
                    return new Date(y, m - 1, d, hh, mm, ss);
                }

                const dt = new Date(s);
                return isNaN(dt.getTime()) ? null : dt;
            };

            // Mostra apenas dias: ex. 10d
            const durationToDays = (ms) => {
                if (ms == null || isNaN(ms)) return '-';
                const dias = Math.floor(Math.max(0, ms) / (24 * 60 * 60 * 1000));
                return `${dias}d`;
            };

            const getTempoVida = (servico) => {
                const dt = parseDateTimeBR(servico.DATA_ABERTURA);
                if (!dt) return '-';
                return durationToDays(agora - dt.getTime());
            };

            const getTempoPendencia = (servico) => {
                const dt = parseDateTimeBR(servico.DATA_STATUS);
                if (!dt) return '-';
                return durationToDays(agora - dt.getTime());
            };

            // SLA: BD = 5 dias | BA = 12 dias (a partir da DATA_ABERTURA)
            const getSlaDias = (servico) => {
                const tipo = (servico.TIPO || '').toString().toUpperCase();
                if (tipo === 'BD') return 5;
                if (tipo === 'BA') return 12;
                return 12;
            };

            const addDays = (dateObj, days) => {
                if (!dateObj) return null;
                const d = new Date(dateObj.getTime());
                d.setDate(d.getDate() + Number(days || 0));
                return d;
            };

            const getSlaRemainingMs = (servico) => {
                const abertura = parseDateTimeBR(servico.DATA_ABERTURA);
                if (!abertura) return null;
                const venc = addDays(abertura, getSlaDias(servico));
                return venc.getTime() - agora;
            };

            const getSlaStatus = (servico) => {
                const ms = getSlaRemainingMs(servico);
                if (ms == null) return 'Sem data';
                if (ms < 0) return 'Vencido';
                if (ms <= 24 * 60 * 60 * 1000) return 'At√© 24h';
                return 'Dentro';
            };

            const getSlaBadge = (status) => {
                switch(status) {
                    case 'Vencido': return 'bg-red-500/20 text-red-300';
                    case 'At√© 24h': return 'bg-amber-500/20 text-amber-300';
                    case 'Dentro': return 'bg-green-500/20 text-green-300';
                    default: return 'bg-gray-500/20 text-gray-300';
                }
            };

            const exportarCSV = () => {
                const headers = ['OS/SS', 'Tipo', 'Cidade', 'Tempo de Vida', 'Tempo na Pend√™ncia', 'SLA (dias)', 'Status SLA', 'Arm√°rio', 'Empresa Rede', 'Splitter Prim√°rio', 'Splitter Secund√°rio', 'Caixa CTO/GP', 'Tipo Caixa', 'Max Secund√°rios', 'Data Vencimento'];
                const linhas = filtrados.map(s => [
                    s.NUMERO_OS || s.COD_SS,
                    s.TIPO,
                    s.CIDADE || s.CITY,
                    getTempoVida(s),
                    getTempoPendencia(s),
                    getSlaDias(s),
                    getSlaStatus(s),
                    s.ARMARIO,
                    s.EMPRESA_REDE || '',
                    s.SPLITTER_PRIMARIO,
                    s.SPLITTER_SECUNDARIO,
                    s.CAIXA_CTO_GP,
                    s.TIPO_CAIXA,
                    s.MAX_SECUNDARIOS || 8,
                    s.DATA_VENCIMENTO
                ]);
                
                const csv = [headers, ...linhas].map(linha => linha.join(';')).join('\n');
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `servicos_porta_cto_${new Date().toISOString().split('T')[0]}.csv`;
                link.click();
            };

            const cidades = [...new Set(servicos.map(s => s.CIDADE || s.CITY).filter(Boolean))].sort();
            const tiposCaixa = [...new Set(servicos.map(s => s.TIPO_CAIXA).filter(Boolean))].sort();
            const empresasRede = [...new Set(servicos.map(s => s.EMPRESA_REDE).filter(Boolean))].sort();

            const abrirMapa = (servico) => {
                const endereco = encodeURIComponent(`${servico.STREETNAME}, ${servico.NEIGHBORDHOOD || servico.NEIGHBORDHOOD}, ${servico.CIDADE || servico.CITY}, RS`);
                window.open(`https://www.google.com/maps/search/?api=1&query=${endereco}`, '_blank');
            };

            const despacharTecnico = (servico) => {
                const mensagem = `üîß *DESPACHO T√âCNICO - PORTA CTO COM DEFEITO*

üìã *OS/SS:* ${servico.NUMERO_OS || servico.COD_SS}
üìç *Tipo:* ${servico.TIPO}
üèôÔ∏è *Cidade:* ${servico.CIDADE || servico.CITY}

üó∫Ô∏è *LOCALIZA√á√ÉO*
Endere√ßo: ${servico.STREETNAME}
Bairro: ${servico.NEIGHBORDHOOD || servico.NEIGHBORDHOOD}
CEP: ${servico.POSTCODE}

üîå *REDE FIBRA √ìTICA*
üè¢ Arm√°rio: ${servico.ARMARIO}
üì° Splitter Prim√°rio: ${servico.SPLITTER_PRIMARIO}
üì° Splitter Secund√°rio: ${servico.SPLITTER_SECUNDARIO}
üì¶ Caixa: ${servico.CAIXA_CTO_GP}
üè∑Ô∏è Tipo Caixa: ${servico.TIPO_CAIXA}
üî¢ Max Secund√°rios: ${servico.MAX_SECUNDARIOS || 8}

‚ö†Ô∏è *STATUS*
Status: ${servico.STATUS}
Motivo: ${servico.NOTDONEREASON}
üìÖ Abertura: ${servico.DATA_ABERTURA}
‚è∞ Vencimento: ${servico.DATA_VENCIMENTO}

üìû *CLIENTE*
Segmento: ${servico.CUSTOMER_SEGMENT}
Rank: ${servico.CUSTOMER_RANK}
Velocidade: ${servico.VELOCIDADEADSL || 'N/A'}

üö® *PRIORIDADE: ALTA*
_Porta CTO com defeito - Atendimento urgente_`;

                const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(mensagem)}`;
                window.open(whatsappUrl, '_blank');
            };

            const getBadgeColor = (tipo) => {
                switch(tipo) {
                    case 'GP (Predial)': return 'bg-blue-500/20 text-blue-300';
                    case 'G0 (CTO Poste)': return 'bg-amber-500/20 text-amber-300';
                    case 'SP (Splitter)': return 'bg-purple-500/20 text-purple-300';
                    default: return 'bg-gray-500/20 text-gray-300';
                }
            };

            

            // =====================

            // M√©tricas do cabe√ßalho

            // =====================

            const getDateKeyBR = (d) => d ? d.toLocaleDateString('pt-BR') : null;

            const formatDateTimeBR = (d) => d ? d.toLocaleString('pt-BR') : 'N/E';


            // √öltimo STATUS (maior DATA_STATUS do dataset)

            const ultimoStatusDate = servicos.reduce((maxD, s) => {

                const d = parseDateTimeBR(s?.DATA_STATUS);

                if (!d) return maxD;

                return (!maxD || d > maxD) ? d : maxD;

            }, null);

            const ultimoStatusStr = formatDateTimeBR(ultimoStatusDate);


            // Entrantes do dia via DATA_STATUS (hoje; se n√£o houver, usa o dia do √∫ltimo status)

            const hojeKey = getDateKeyBR(new Date());

            const entrantesHoje = servicos.filter(s => getDateKeyBR(parseDateTimeBR(s?.DATA_STATUS)) === hojeKey);

            const diaRefKey = (entrantesHoje.length > 0) ? hojeKey : getDateKeyBR(ultimoStatusDate);

            const entrantesDia = servicos.filter(s => getDateKeyBR(parseDateTimeBR(s?.DATA_STATUS)) === diaRefKey);

            const entrantesPorStatus = entrantesDia.reduce((acc, s) => {

                const st = (s?.STATUS ? String(s.STATUS).toUpperCase().trim() : 'SEM STATUS');

                acc[st] = (acc[st] || 0) + 1;

                return acc;

            }, {});

            const entrantesTotalDia = entrantesDia.length;


            // Entrantes do dia por EMPRESA_REDE (somente EMPRESA_REDE)

            const entrantesPorEmpresa = entrantesDia.reduce((acc, s) => {

                const emp = (s?.EMPRESA_REDE ? String(s.EMPRESA_REDE).toUpperCase().trim() : 'SEM EMPRESA');

                acc[emp] = (acc[emp] || 0) + 1;

                return acc;

            }, {});
return (
                <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-6">
                    <div className="max-w-7xl mx-auto">
                        <div className="mb-8">
                            <h1 className="text-4xl font-bold text-white mb-2">
                                üîß Dashboard - Porta CTO
                            </h1>
                            <div className="text-blue-100 text-sm flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-4">
                                <span>√öltimo status: <span className="font-semibold">{ultimoStatusStr}</span></span>
                                <span className="hidden sm:inline opacity-60">‚Ä¢</span>
                                <span>Entrantes (<span className="font-semibold">{diaRefKey || 'N/E'}</span>): <span className="font-semibold">{entrantesTotalDia}</span></span>
                            </div>
                            <div className="text-blue-200 text-xs mt-1 flex flex-wrap items-center gap-x-2 gap-y-1">
                                <span className="bg-white/10 rounded-full px-2 py-0.5 border border-white/10">ENTRANTES: <span className="font-semibold">{entrantesTotalDia}</span></span>
                                <span className="opacity-40">|</span>
                                <span className="bg-white/10 rounded-full px-2 py-0.5 border border-white/10">TLP: <span className="font-semibold">{entrantesPorEmpresa['TLP'] || 0}</span></span>
                                <span className="opacity-40">|</span>
                                <span className="bg-white/10 rounded-full px-2 py-0.5 border border-white/10">VIVO: <span className="font-semibold">{entrantesPorEmpresa['VIVO'] || 0}</span></span>
                            </div>

                            <p className="text-blue-200">Servi√ßos de manuten√ß√£o em redes de fibra √≥tica (excluindo FIBRASIL)</p>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-6 gap-4 mb-6">
                            <div className="bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-blue-200 text-sm">Total Servi√ßos</p>
                                        <p className="text-white text-3xl font-bold">{servicos.length}</p>
                                    </div>
                                    <div className="text-yellow-400"><AlertIcon /></div>
                                </div>
                            </div>
                            
                            <div className="bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-blue-200 text-sm">Filtrados</p>
                                        <p className="text-white text-3xl font-bold">{filtrados.length}</p>
                                    </div>
                                    <div className="text-blue-400"><FilterIcon /></div>
                                </div>
                            </div>
                            
                            <div className="bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-blue-200 text-sm">BA (Instala√ß√£o)</p>
                                        <p className="text-white text-3xl font-bold">
                                            {servicos.filter(s => s.TIPO === 'BA').length}
                                        </p>
                                    </div>
                                    <div className="text-green-400"><MapPinIcon /></div>
                                </div>
                            </div>
                            
                            <div className="bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-blue-200 text-sm">BD (Defeito)</p>
                                        <p className="text-white text-3xl font-bold">
                                            {servicos.filter(s => s.TIPO === 'BD').length}
                                        </p>
                                    </div>
                                    <div className="text-purple-400"><MapPinIcon /></div>
                                </div>
                            </div>

                            
                            <div className="bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-blue-200 text-sm">Empresa: VIVO</p>
                                        <p className="text-white text-3xl font-bold">
                                            {servicos.filter(s => (s.EMPRESA_REDE || '').toUpperCase() === 'VIVO').length}
                                        </p>
                                    </div>
                                    <div className="text-sky-400"><AlertIcon /></div>
                                </div>
                            </div>

                            <div className="bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-blue-200 text-sm">Empresa: TLP</p>
                                        <p className="text-white text-3xl font-bold">
                                            {servicos.filter(s => (s.EMPRESA_REDE || '').toUpperCase() === 'TLP').length}
                                        </p>
                                    </div>
                                    <div className="text-amber-400"><AlertIcon /></div>
                                </div>
                            </div>

                            

                        </div>

                        <div className="bg-white/10 backdrop-blur-md rounded-xl p-6 mb-6 border border-white/20">
                            <div className="grid grid-cols-1 md:grid-cols-6 gap-4">
                                <div className="relative md:col-span-2">
                                    <div className="absolute left-3 top-3 text-gray-400"><SearchIcon /></div>
                                    <input
                                        type="text"
                                        placeholder="Buscar OS/SS, Arm√°rio, Splitter, Caixa..."
                                        value={filtroTexto}
                                        onChange={(e) => setFiltroTexto(e.target.value)}
                                        className="w-full pl-10 pr-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400"
                                    />
                                </div>
                                
                                <select value={filtroTipo} onChange={(e) => setFiltroTipo(e.target.value)} className="px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-400">
                                    <option value="todos" className="bg-gray-800">Todos</option>
                                    <option value="BA" className="bg-gray-800">BA</option>
                                    <option value="BD" className="bg-gray-800">BD</option>
                                </select>

                                <select value={filtroCidade} onChange={(e) => setFiltroCidade(e.target.value)} className="px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-400">
                                    <option value="todos" className="bg-gray-800">Cidades</option>
                                    {cidades.map(cidade => (
                                        <option key={cidade} value={cidade} className="bg-gray-800">{cidade}</option>
                                    ))}
                                </select>

                                <select value={filtroEmpresa} onChange={(e) => setFiltroEmpresa(e.target.value)} className="px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-400">
                                    <option value="todos" className="bg-gray-800">Empresas</option>
                                    <option value="sem" className="bg-gray-800">Sem empresa</option>
                                    {empresasRede.map(emp => (
                                        <option key={emp} value={String(emp).toUpperCase()} className="bg-gray-800">{emp}</option>
                                    ))}
                                </select>

                                <select value={filtroTipoCaixa} onChange={(e) => setFiltroTipoCaixa(e.target.value)} className="px-4 py-2 bg-white/20 border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-400">
                                    <option value="todos" className="bg-gray-800">Tipo Caixa</option>
                                    {tiposCaixa.map(tipo => (
                                        <option key={tipo} value={tipo} className="bg-gray-800">{tipo}</option>
                                    ))}
                                </select>
                            </div>
                            
                            <div className="mt-4 flex flex-wrap gap-3 items-center">
                                <button onClick={exportarCSV} className="flex items-center gap-2 px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors">
                                    <DownloadIcon />
                                    Exportar CSV ({filtrados.length})
                                </button>
                                <div className="flex-1"></div>
                                <div className="text-xs text-blue-200 flex gap-2 flex-wrap">
                                    <span className="px-2 py-1 bg-blue-500/20 text-blue-300 rounded">üì¶ GP=Predial</span>
                                    <span className="px-2 py-1 bg-amber-500/20 text-amber-300 rounded">üìç G0=Poste</span>
                                    <span className="px-2 py-1 bg-purple-500/20 text-purple-300 rounded">üîÄ SP=Splitter</span>
                                    <span className="px-2 py-1 bg-pink-500/20 text-pink-300 rounded">üî¢ A/B/C=4sec | Outros=8sec</span>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white/10 backdrop-blur-md rounded-xl overflow-hidden border border-white/20">
                            <div className="table-scroll">
                                <table className="w-full">
                                    <thead className="bg-white/5 sticky top-0">
                                        <tr>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">OS/SS</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">Tipo</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">Cidade</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">Tempo de Vida</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">Tempo na Pend√™ncia</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">SLA (dias)</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">Status SLA</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">Arm√°rio</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">Empresa Rede</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">Splitter 1¬∫</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">Splitter 2¬∫</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">Caixa</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">Tipo</th>
                                            <th className="px-3 py-3 text-left text-xs font-semibold text-blue-200">A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-white/10">
                                        {filtrados.map((servico, index) => (
                                            <tr key={index} className="hover:bg-white/5 transition-colors">
                                                <td className="px-3 py-2 text-white font-mono text-xs">
                                                    {servico.NUMERO_OS || servico.COD_SS}
                                                </td>
                                                <td className="px-3 py-2">
                                                    <span className={`px-2 py-1 rounded text-xs font-semibold ${
                                                        servico.TIPO === 'BA' ? 'bg-green-500/20 text-green-300' : 'bg-purple-500/20 text-purple-300'
                                                    }`}>
                                                        {servico.TIPO}
                                                    </span>
                                                </td>
                                                <td className="px-3 py-2 text-white text-xs">
                                                    {servico.CIDADE || servico.CITY}
                                                </td>
                                                <td className="px-3 py-2 text-white text-xs font-mono" title={`Abertura: ${servico.DATA_ABERTURA || '-'}`}>{getTempoVida(servico)}</td>
                                                <td className="px-3 py-2 text-white text-xs font-mono" title={`Status: ${servico.DATA_STATUS || '-'}`}>{getTempoPendencia(servico)}</td>
                                                <td className="px-3 py-2 text-white text-xs font-mono">{getSlaDias(servico)}</td>
                                                <td className="px-3 py-2">
                                                    <span className={`px-2 py-1 rounded text-xs font-semibold ${getSlaBadge(getSlaStatus(servico))}`}>{getSlaStatus(servico)}</span>
                                                </td>
                                                <td className="px-3 py-2 text-blue-200 text-xs font-mono">
                                                    {servico.ARMARIO}
                                                </td>
                                                <td className="px-3 py-2 text-white text-xs">
                                                    {servico.EMPRESA_REDE || '-'}
                                                </td>
                                                <td className="px-3 py-2 text-blue-200 text-xs font-mono">
                                                    {servico.SPLITTER_PRIMARIO}
                                                </td>
                                                <td className="px-3 py-2 text-blue-200 text-xs font-mono">
                                                    {servico.SPLITTER_SECUNDARIO}
                                                </td>
                                                <td className="px-3 py-2 text-blue-200 text-xs font-mono">
                                                    {servico.CAIXA_CTO_GP}
                                                </td>
                                                <td className="px-3 py-2">
                                                    <span className={`px-2 py-1 rounded text-xs font-semibold ${getBadgeColor(servico.TIPO_CAIXA)}`}>
                                                        {servico.TIPO_CAIXA.split(' ')[0]}
                                                    </span>
                                                </td>
                                                <td className="px-3 py-2">
                                                    <div className="flex gap-1">
                                                        <button 
                                                            onClick={() => setSelectedOS(servico)}
                                                            className="px-2 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded text-xs transition-colors"
                                                        >
                                                            Ver
                                                        </button>
                                                        <button 
                                                            onClick={() => abrirMapa(servico)}
                                                            className="px-2 py-1 bg-emerald-500 hover:bg-emerald-600 text-white rounded text-xs transition-colors"
                                                        >
                                                            Mapa
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                            
                            {filtrados.length === 0 && (
                                <div className="text-center py-12 text-blue-200">
                                    Nenhum servi√ßo encontrado.
                                </div>
                            )}
                        </div>

                        {selectedOS && (
                            <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50" onClick={() => setSelectedOS(null)}>
                                <div className="bg-gradient-to-br from-gray-900 to-gray-800 rounded-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-white/20" onClick={(e) => e.stopPropagation()}>
                                    <div className="flex items-center justify-between mb-6">
                                        <h2 className="text-2xl font-bold text-white">
                                            üìã {selectedOS.TIPO === 'BA' ? 'OS' : 'SS'}: {selectedOS.NUMERO_OS || selectedOS.COD_SS}
                                        </h2>
                                        <button onClick={() => setSelectedOS(null)} className="text-white hover:text-red-400 text-3xl font-bold">√ó</button>
                                    </div>
                                    
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="col-span-2 bg-white/5 p-4 rounded-lg">
                                            <h3 className="text-lg font-bold text-blue-300 mb-3">üìç Localiza√ß√£o</h3>
                                            <div className="grid grid-cols-2 gap-3 text-sm">
                                                <div className="col-span-2"><span className="text-blue-300">Endere√ßo:</span> <span className="text-white">{selectedOS.STREETNAME}</span></div>
                                                <div><span className="text-blue-300">Bairro:</span> <span className="text-white">{selectedOS.NEIGHBORDHOOD || selectedOS.NEIGHBORDHOOD}</span></div>
                                                <div><span className="text-blue-300">Cidade:</span> <span className="text-white">{selectedOS.CIDADE || selectedOS.CITY}</span></div>
                                            </div>
                                            <button onClick={() => abrirMapa(selectedOS)} className="mt-3 w-full flex items-center justify-center gap-2 px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg">
                                                <NavigationIcon />
                                                Google Maps
                                            </button>
                                        </div>

                                        <div className="col-span-2 bg-white/5 p-4 rounded-lg">
                                            <h3 className="text-lg font-bold text-blue-300 mb-3">üîß Dados de Rede</h3>
                                            <div className="grid grid-cols-2 gap-3 text-sm">
                                                <div><span className="text-blue-300">Arm√°rio:</span> <span className="text-white font-mono">{selectedOS.ARMARIO}</span></div>
                                                <div><span className="text-blue-300">Max Secund√°rios:</span> <span className="text-white">{selectedOS.MAX_SECUNDARIOS || 8}</span></div>
                                                <div><span className="text-blue-300">Splitter Prim√°rio:</span> <span className="text-white font-mono">{selectedOS.SPLITTER_PRIMARIO}</span></div>
                                                <div><span className="text-blue-300">Splitter Secund√°rio:</span> <span className="text-white font-mono">{selectedOS.SPLITTER_SECUNDARIO}</span></div>
                                                <div className="col-span-2">
                                                    <span className="text-blue-300">Caixa:</span> <span className="text-white font-mono">{selectedOS.CAIXA_CTO_GP}</span>
                                                    <span className={`ml-2 px-2 py-1 rounded text-xs font-semibold ${getBadgeColor(selectedOS.TIPO_CAIXA)}`}>
                                                        {selectedOS.TIPO_CAIXA}
                                                    </span>
                                                </div>
                                                <div><span className="text-blue-300">Cabo Prim√°rio:</span> <span className="text-white">{selectedOS.CABO_PRIMARIO}</span></div>
                                                <div><span className="text-blue-300">Par Prim√°rio:</span> <span className="text-white">{selectedOS.PAR_PRIMARIO}</span></div>
                                            </div>
                                        </div>

                                        <div className="col-span-2 bg-white/5 p-4 rounded-lg">
                                            <h3 className="text-lg font-bold text-blue-300 mb-3">üì° Dados T√©cnicos</h3>
                                            <div className="grid grid-cols-2 gap-3 text-sm">
                                                <div className="col-span-2"><span className="text-blue-300">ID Fibra:</span> <span className="text-white font-mono text-xs">{selectedOS.ID_FIBRA}</span></div>
                                                <div className="col-span-2"><span className="text-blue-300">OLT:</span> <span className="text-white font-mono text-xs">{selectedOS.OLT}</span></div>
                                                <div><span className="text-blue-300">Tecnologia:</span> <span className="text-white">{selectedOS.SERVICE_TECHNOLOGY}</span></div>
                                                <div><span className="text-blue-300">Velocidade:</span> <span className="text-white">{selectedOS.VELOCIDADEADSL || 'N/A'}</span></div>
                                            </div>
                                        </div>

                                        <div className="col-span-2 bg-white/5 p-4 rounded-lg">
                                            <h3 className="text-lg font-bold text-blue-300 mb-3">‚ö†Ô∏è Status</h3>
                                            <div className="grid grid-cols-2 gap-3 text-sm">
                                                <div><span className="text-blue-300">Status:</span> <span className="text-white">{selectedOS.STATUS}</span></div>
                                                <div className="col-span-2"><span className="text-blue-300">Motivo:</span> <span className="text-yellow-300 font-semibold">{selectedOS.NOTDONEREASON}</span></div>
                                                <div><span className="text-blue-300">Abertura:</span> <span className="text-white text-xs">{selectedOS.DATA_ABERTURA}</span></div>
                                                <div><span className="text-blue-300">Vencimento:</span> <span className="text-white text-xs">{selectedOS.DATA_VENCIMENTO}</span></div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div className="mt-6 grid grid-cols-2 gap-3">
                                        <button 
                                            onClick={() => despacharTecnico(selectedOS)}
                                            className="px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold transition-all hover:scale-105">
                                            üì± Despachar T√©cnico
                                        </button>
                                        <button className="px-4 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold">
                                            üìÑ Gerar Relat√≥rio
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        ReactDOM.render(<DashboardFibra />, document.getElementById('root'));
    </script>
</body>
</html>
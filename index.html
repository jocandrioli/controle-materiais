<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gerador de Carimbo - Acionamento GPON</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; background-color: #f5f5f5; padding: 20px; line-height: 1.6; }
    .container { max-width: 1000px; margin: 0 auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,.1); overflow: hidden; }
    .header { background: #003366; color: #fff; padding: 20px; text-align: center; }
    .header h1 { font-size: 24px; margin-bottom: 5px; }
    .header p { font-size: 12px; opacity: .9; }
    .form-group { margin-bottom: 12px; display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .form-group.full { grid-template-columns: 1fr; }
    .form-group.three-col { grid-template-columns: 1fr 1fr 1fr; }
    label { display: block; font-size: 12px; font-weight: 700; color: #333; margin-bottom: 4px; }
    input[type="text"], input[type="email"], input[type="tel"], input[type="number"], input[type="date"], input[type="time"], textarea, select {
      width: 100%; padding: 8px; border: 1px solid #999; border-radius: 4px; font-size: 12px; font-family: Arial, sans-serif;
    }
    textarea { resize: vertical; min-height: 60px; }
    input:focus, textarea:focus, select:focus { outline: none; border-color: #ff6600; background: #fffef0; }
    .section { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 4px; background: #fafafa; }
    .section-title { font-weight: 700; color: #003366; margin-bottom: 12px; font-size: 14px; border-bottom: 2px solid #ff6600; padding-bottom: 8px; }
    .header-section { background: #f9f9f9; padding: 20px; border-bottom: 2px solid #004d99; }
    .header-section h2 { color: #003366; font-size: 16px; margin-bottom: 15px; }
    .dynamic-content { padding: 20px; display: none; }
    .dynamic-content.active { display: block; }
    .checkbox-group { display: flex; gap: 15px; margin-top: 8px; }
    .checkbox-group label { display: inline-flex; align-items: center; margin-bottom: 0; font-weight: 600; }
    .checkbox-group input[type="checkbox"], .checkbox-group input[type="radio"] { width: auto; margin-right: 6px; }
    .actions { display: flex; gap: 10px; margin-top: 20px; justify-content: space-between; flex-wrap: wrap; }
    button { padding: 10px 20px; font-size: 12px; border: 0; border-radius: 4px; cursor: pointer; font-weight: 700; transition: .3s; }
    .btn-generate { background: #ff6600; color: #fff; flex: 1; min-width: 120px; }
    .btn-generate:hover { background: #e55a00; }
    .btn-copy { background: #0066cc; color: #fff; flex: 1; min-width: 120px; }
    .btn-copy:hover { background: #0052a3; }
    .btn-clear { background: #999; color: #fff; flex: 1; min-width: 120px; }
    .btn-clear:hover { background: #777; }
    .output-section { margin-top: 20px; padding: 15px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 4px; display: none; }
    .output-section.active { display: block; }
    .output-section h3 { color: #003366; margin-bottom: 10px; font-size: 14px; }
    .output-text { background: #fff; padding: 12px; border: 1px solid #999; border-radius: 4px; font-family: "Courier New", monospace; font-size: 11px; line-height: 1.6; color: #333; max-height: 300px; overflow-y: auto; white-space: pre-wrap; word-break: break-word; }
    .success-message { background: #d4edda; color: #155724; padding: 10px; border-radius: 4px; margin-top: 10px; font-size: 12px; display: none; }
    .success-message.show { display: block; }
    @media (max-width: 768px) {
      .form-group { grid-template-columns: 1fr; }
      .form-group.three-col { grid-template-columns: 1fr; }
      .actions { flex-direction: column; }
      button { width: 100%; }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>üìã Gerador de Carimbo - RS-CAPITAL</h1>
      <p>Sistema de Acionamento - GPON - Vivo Rede</p>
    </div>

    <div class="header-section">
      <h2>Dados Gerais (Preenchidos para todos os carimbos)</h2>

      <div class="form-group">
        <div>
          <label>ID Ocorr√™ncia/OS CTO (BA/TT)</label>
          <input type="text" id="id_ocorrencia" placeholder="Ex: 123456">
        </div>
        <div>
          <label>Selecione o Tipo de Carimbo</label>
          <select id="carimbo_tipo">
            <option value="">-- Selecione --</option>
            <option value="acionamento">1. Acionamento</option>
            <option value="deslocamento">2. Deslocamento ao Ponto da Falha</option>
            <option value="recuperacao">3. Recupera√ß√£o da Falha</option>
            <option value="certificacao">4. Certifica√ß√£o</option>
            <option value="complementar">Complementar</option>
            <option value="naofalha">N√£o h√° Falha para Rede</option>
            <option value="transbordo">Transbordo</option>
            <option value="prazo">Prazo de Reparo</option>
            <option value="cire">CIRE</option>
            <option value="escalonamento">Escalonamento sem Equipe</option>
            <option value="cto_defeito">CTO com Defeito</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <div>
          <label>SUPERVISOR</label>
          <input type="text" id="supervisor" list="supervisorList" placeholder="Nome do Supervisor">
          <datalist id="supervisorList">
            <option value="Alexandre Ilha"></option>
            <option value="Diego Jaworski"></option>
            <option value="Diego Richter"></option>
            <option value="Marcio Mendes"></option>
            <option value="M√°rio Pereira"></option>
            <option value="Rodrigo Duarte"></option>
            <option value="Rodrigo Rosa"></option>
          </datalist>
        </div>
        <div>
          <label>Telefone Supervisor</label>
          <input type="tel" id="supervisor_tel" placeholder="(51) 9XXXX-XXXX">
        </div>
      </div>

      <div class="form-group">
        <div>
          <label>T√âCNICO</label>
          <input type="text" id="tecnico" placeholder="Nome do T√©cnico">
        </div>
        <div>
          <label>Telefone T√©cnico</label>
          <input type="tel" id="tecnico_tel" placeholder="(51) 9XXXX-XXXX">
        </div>
      </div>

      <div class="form-group full">
        <div>
          <label>Analista CCR</label>
          <input type="text" id="analista_ccr" list="analistaList" placeholder="Digite para pesquisar ou selecione na lista">
          <datalist id="analistaList">
            <option value="CARINA DE FATIMA CHUQUEL"></option>
            <option value="EDMILSON GARCIA RIEIRA"></option>
            <option value="EDUARDA PAIVA RODRIGUES"></option>
            <option value="JULIA DOS SANTOS DA SILVA"></option>
            <option value="MATHEUS ALVES CASTRO"></option>
            <option value="RAFAELA VERCH DIAS"></option>
            <option value="SILVIO LUIZ RACHOR PUTRIQUE"></option>
          </datalist>
        </div>
      </div>
    </div>

    <div class="dynamic-content active" id="content-default">
      <div class="section">
        <p style="color: #666; text-align: center; padding: 40px 20px;">
          Selecione um tipo de carimbo acima para ver os campos espec√≠ficos.
        </p>
      </div>
    </div>

    <div class="dynamic-content" id="content-acionamento">
      <div class="section">
        <div class="section-title">ACIONAMENTO</div>
        <div class="form-group">
          <div>
            <label>Previs√£o de chegada ao SITE/ARO para medi√ß√µes</label>
            <input type="time" id="acionamento_prev_chegada">
          </div>
          <div>
            <label>Nome SITE/ARO para medi√ß√µes</label>
            <input type="text" id="acionamento_site" list="siteList" placeholder="Digite para pesquisar ou selecione na lista">
            <datalist id="siteList">
              <option value="RSCBM_G1N01"></option>
              <option value="RSCBM_O1A01"></option>
              <option value="RSCQU_G1I01"></option>
              <option value="RSGUB_G1N01"></option>
              <option value="RSPAE_G1B95"></option>
              <option value="RSPAE_G1C01"></option>
              <option value="RSPAE_G1I22"></option>
              <option value="RSPAE_G1I23"></option>
              <option value="RSPAE_G1I24"></option>
              <option value="RSPAE_G1I25"></option>
              <option value="RSPAE_G1I26"></option>
              <option value="RSPAE_G1I32"></option>
              <option value="RSPAE_G1I33"></option>
              <option value="RSPAE_G1I35"></option>
              <option value="RSPAE_G1I41"></option>
              <option value="RSPAE_G1I47"></option>
              <option value="RSPAE_G1I48"></option>
              <option value="RSPAE_G1I55"></option>
              <option value="RSPAE_G1N42"></option>
              <option value="RSPAE_G1N45"></option>
              <option value="RSSLE_O1A04"></option>
            </datalist>
          </div>
        </div>
        <div class="actions">
          <button class="btn-generate" onclick="generateStamp('acionamento')">Gerar Carimbo</button>
          <button class="btn-clear" onclick="clearDynamic()">Limpar Formul√°rio</button>
        </div>
      </div>
    </div>

    <div class="dynamic-content" id="content-deslocamento">
      <div class="section">
        <div class="section-title">DESLOCAMENTO AO PONTO DA FALHA</div>
        <div class="form-group">
          <div>
            <label>KM at√© o LOCAL da falha</label>
            <input type="number" id="deslocamento_km" placeholder="Ex: 15.5" step="0.1">
          </div>
          <div>
            <label>Previs√£o de chegada ao LOCAL da falha</label>
            <input type="time" id="deslocamento_prev_chegada">
          </div>
        </div>
        <div class="form-group full">
          <div>
            <label>Observa√ß√µes</label>
            <textarea id="deslocamento_obs" placeholder="Observa√ß√µes sobre o deslocamento"></textarea>
          </div>
        </div>
        <div class="actions">
          <button class="btn-generate" onclick="generateStamp('deslocamento')">Gerar Carimbo</button>
          <button class="btn-clear" onclick="clearDynamic()">Limpar Formul√°rio</button>
        </div>
      </div>
    </div>

    <div class="dynamic-content" id="content-recuperacao">
      <div class="section">
        <div class="section-title">RECUPERA√á√ÉO DA FALHA</div>
        <div class="form-group">
          <div>
            <label>Causa raiz</label>
            <select id="recuperacao_causa">
              <option value="" disabled selected>Selecione</option>
              <option value="Abalroamento">Abalroamento</option>
              <option value="Furto">Furto</option>
              <option value="Acidente">Acidente</option>
              <option value="Descarga">Descarga</option>
              <option value="Vandalismo">Vandalismo</option>
              <option value="Troca de poste">Troca de poste</option>
              <option value="Degrada√ß√£o / Infiltra√ß√£o">Degrada√ß√£o / Infiltra√ß√£o</option>
              <option value="Defeito Splitter">Defeito Splitter</option>
              <option value="Falha em atividade anterior">Falha em atividade anterior</option>
              <option value="Obra de terceiros">Obra de terceiros</option>
              <option value="Interperie">Interperie</option>
              <option value="Ataque de animais">Ataque de animais</option>
            </select>
          </div>
          <div>
            <label>Previs√£o para solicita√ß√£o de testes</label>
            <input type="time" id="recuperacao_prev_testes">
          </div>
        </div>
        <div class="form-group">
          <div>
            <label>Endere√ßo da falha</label>
            <input type="text" id="recuperacao_endereco" placeholder="Rua, N√∫mero, Complemento">
          </div>
          <div>
            <label>Cabo / Capacidade / ARO</label>
            <input type="text" id="recuperacao_cabo" placeholder="Ex: DROP 4F, 12F, 24F, 36F, 48F, 72F, 144F">
          </div>
        </div>
        <div class="form-group full">
          <div>
            <label>Tratativas realizadas</label>
            <textarea id="recuperacao_tratativas" placeholder="Descreva as tratativas"></textarea>
          </div>
        </div>
        <div class="form-group full">
          <div>
            <label>Observa√ß√µes</label>
            <textarea id="recuperacao_obs" placeholder="Observa√ß√µes gerais"></textarea>
          </div>
        </div>
        <div class="actions">
          <button class="btn-generate" onclick="generateStamp('recuperacao')">Gerar Carimbo</button>
          <button class="btn-clear" onclick="clearDynamic()">Limpar Formul√°rio</button>
        </div>
      </div>
    </div>

    <div class="dynamic-content" id="content-certificacao">
      <div class="section">
        <div class="section-title">SOLICITA√á√ÉO DE CERTIFICA√á√ÉO</div>
        <div class="form-group full">
          <div>
            <label>Tratativa realizada</label>
            <textarea id="certificacao_tratativa" placeholder="Descri√ß√£o da tratativa realizada"></textarea>
          </div>
        </div>
        <div class="form-group">
          <div>
            <label>Causa</label>
            <select id="certificacao_causa">
              <option value="" disabled selected>Selecione</option>
              <option value="Abalroamento">Abalroamento</option>
              <option value="Furto">Furto</option>
              <option value="Acidente">Acidente</option>
              <option value="Descarga">Descarga</option>
              <option value="Vandalismo">Vandalismo</option>
              <option value="Troca de poste">Troca de poste</option>
              <option value="Degrada√ß√£o / Infiltra√ß√£o">Degrada√ß√£o / Infiltra√ß√£o</option>
              <option value="Defeito Splitter">Defeito Splitter</option>
              <option value="Falha em atividade anterior">Falha em atividade anterior</option>
              <option value="Obra de terceiros">Obra de terceiros</option>
              <option value="Interperie">Interperie</option>
              <option value="Ataque de animais">Ataque de animais</option>
            </select>
          </div>
          <div>
            <label>Material utilizado</label>
            <input type="text" id="certificacao_material" placeholder="Ex: Conector SC, Fibra √≥ptica">
          </div>
        </div>
        <div class="form-group">
          <div>
            <label>Foto em anexo</label>
            <div class="checkbox-group">
              <label><input type="radio" name="certificacao_foto" value="Sim"> Sim</label>
              <label><input type="radio" name="certificacao_foto" value="N√£o"> N√£o</label>
            </div>
          </div>
        </div>
        <div class="actions">
          <button class="btn-generate" onclick="generateStamp('certificacao')">Gerar Carimbo</button>
          <button class="btn-clear" onclick="clearDynamic()">Limpar Formul√°rio</button>
        </div>
      </div>
    </div>

    <div class="dynamic-content" id="content-complementar">
      <div class="section">
        <div class="section-title">COMPLEMENTAR</div>
        <div class="form-group">
          <div>
            <label>Motivo</label>
            <input type="text" id="complementar_motivo" placeholder="Motivo da complementa√ß√£o">
          </div>
          <div>
            <label>Informa√ß√£o</label>
            <input type="text" id="complementar_info" placeholder="Informa√ß√£o adicional">
          </div>
        </div>
        <div class="form-group">
          <div>
            <label>Nova previs√£o?</label>
            <div class="checkbox-group">
              <label><input type="radio" name="nova_previsao" value="Sim"> Sim</label>
              <label><input type="radio" name="nova_previsao" value="N√£o"> N√£o</label>
            </div>
          </div>
          <div>
            <label>Previs√£o</label>
            <input type="time" id="complementar_previsao">
          </div>
        </div>
        <div class="actions">
          <button class="btn-generate" onclick="generateStamp('complementar')">Gerar Carimbo</button>
          <button class="btn-clear" onclick="clearDynamic()">Limpar Formul√°rio</button>
        </div>
      </div>
    </div>

    <div class="dynamic-content" id="content-naofalha">
      <div class="section">
        <div class="section-title">N√ÉO H√Å FALHA PARA REDE</div>
        <div class="form-group full">
          <div>
            <label>Motivo da Improdutiva</label>
            <textarea id="naofalha_motivo" placeholder="Descreva o motivo da improdutiva"></textarea>
          </div>
        </div>
        <div class="form-group">
          <div>
            <label>Foto em anexo</label>
            <div class="checkbox-group">
              <label><input type="radio" name="naofalha_foto" value="Sim"> Sim</label>
              <label><input type="radio" name="naofalha_foto" value="N√£o"> N√£o</label>
            </div>
          </div>
          <div>
            <label>Ciente (Gestor VIVO Rede)</label>
            <input type="text" id="naofalha_gestor" value="Jo√£o Andrioli" readonly>
          </div>
        </div>
        <div class="actions">
          <button class="btn-generate" onclick="generateStamp('naofalha')">Gerar Carimbo</button>
          <button class="btn-clear" onclick="clearDynamic()">Limpar Formul√°rio</button>
        </div>
      </div>
    </div>

    <div class="dynamic-content" id="content-transbordo">
      <div class="section">
        <div class="section-title">TRANSBORDO</div>
        <div class="form-group">
          <div>
            <label>TA</label>
            <input type="text" id="transbordota" placeholder="TA">
          </div>
          <div>
            <label>CONTRATO</label>
            <input type="text" id="transbordocontrato" placeholder="Contrato">
          </div>
        </div>
        <div class="form-group">
          <div>
            <label>TRANSBORDO</label>
            <input type="text" id="transbordooperadora" value="VIVO" readonly>
          </div>
        </div>
        <div class="actions">
          <button class="btn-generate" onclick="generateStamp('transbordo')">Gerar Carimbo</button>
          <button class="btn-clear" onclick="clearDynamic()">Limpar Formul√°rio</button>
        </div>
      </div>
    </div>

    <div class="dynamic-content" id="content-prazo">
      <div class="section">
        <div class="section-title">PRAZO DE REPARO</div>
        <div class="form-group">
          <div>
            <label>Cargo</label>
            <input type="text" id="prazoreparocargo" value="Coordenador" readonly>
          </div>
          <div>
            <label>Nome / Telefone</label>
            <input type="text" id="prazoreparonometel" value="Jo√£o Andrioli / 41 99244-9441" readonly>
          </div>
        </div>
        <div class="form-group">
          <div>
            <label>SLA do evento</label>
            <input type="text" id="prazoreparosla" placeholder="Ex: 4h, 2h">
          </div>
          <div>
            <label>Observa√ß√µes</label>
            <input type="text" id="prazoreparoobs" placeholder="Observa√ß√µes">
          </div>
        </div>
        <div class="actions">
          <button class="btn-generate" onclick="generateStamp('prazo')">Gerar Carimbo</button>
          <button class="btn-clear" onclick="clearDynamic()">Limpar Formul√°rio</button>
        </div>
      </div>
    </div>

    <div class="dynamic-content" id="content-cire">
      <div class="section">
        <div class="section-title">INTERVEN√á√ÉO CIRE</div>
        <div class="form-group">
          <div>
            <label>Solicitante</label>
            <input type="text" id="cire_solicitante" placeholder="Nome do Solicitante">
          </div>
          <div>
            <label>Meio de contato</label>
            <div class="checkbox-group">
              <label><input type="radio" name="cire_contato" value="Telefone"> Telefone</label>
              <label><input type="radio" name="cire_contato" value="E-mail"> E-mail</label>
              <label><input type="radio" name="cire_contato" value="WhatsApp"> WhatsApp</label>
            </div>
          </div>
        </div>
        <div class="form-group full">
          <div>
            <label>Motivo</label>
            <textarea id="cire_motivo" placeholder="Descreva o motivo da interven√ß√£o CIRE"></textarea>
          </div>
        </div>
        <div class="form-group full">
          <div>
            <label>Informa√ß√£o</label>
            <textarea id="cire_info" placeholder="Informa√ß√µes adicionais"></textarea>
          </div>
        </div>
        <div class="form-group">
          <div>
            <label>Previs√£o</label>
            <input type="time" id="cire_previsao">
          </div>
        </div>
        <div class="actions">
          <button class="btn-generate" onclick="generateStamp('cire')">Gerar Carimbo</button>
          <button class="btn-clear" onclick="clearDynamic()">Limpar Formul√°rio</button>
        </div>
      </div>
    </div>

    <div class="dynamic-content" id="content-escalonamento">
      <div class="section">
        <div class="section-title">ESCALONAMENTO SEM EQUIPE</div>
        <div class="form-group">
          <div>
            <label>Cargo</label>
            <input type="text" id="escalonamento_cargo" value="Coordenador" readonly>
          </div>
          <div>
            <label>Nome / Telefone</label>
            <input type="text" id="escalonamento_nome_tel" value="Jo√£o Andrioli / 41 99244-9441" readonly>
          </div>
        </div>
        <div class="form-group">
          <div>
            <label>SLA do evento</label>
            <input type="text" id="escalonamento_sla" placeholder="Ex: 4h, 2h">
          </div>
          <div>
            <label>Observa√ß√µes</label>
            <input type="text" id="escalonamento_obs" placeholder="Observa√ß√µes">
          </div>
        </div>
        <div class="actions">
          <button class="btn-generate" onclick="generateStamp('escalonamento')">Gerar Carimbo</button>
          <button class="btn-clear" onclick="clearDynamic()">Limpar Formul√°rio</button>
        </div>
      </div>
    </div>

    <div class="dynamic-content" id="content-cto_defeito">
      <div class="section">
        <div class="section-title">CTO COM DEFEITO</div>
        <div class="form-group">
          <div>
            <label>Nome SITE/ARO</label>
            <input type="text" id="cto_defeito_site" list="siteList" placeholder="Digite para pesquisar ou selecione na lista">
          </div>
          <div>
            <label>Splitter</label>
            <input type="text" id="cto_defeito_splitter" placeholder="Ex: SP001, SP144">
          </div>
        </div>
        <div class="form-group">
          <div>
            <label>Caixa</label>
            <input type="text" id="cto_defeito_caixa" placeholder="Ex: G0001, G0099, GP0050">
          </div>
          <div>
            <label>Endere√ßo</label>
            <input type="text" id="cto_defeito_endereco" placeholder="Rua, N√∫mero, Complemento">
          </div>
        </div>
        <div class="form-group">
          <div>
            <label>Causa</label>
            <select id="cto_defeito_causa">
              <option value="" disabled selected>Selecione</option>
              <option value="Abalroamento">Abalroamento</option>
              <option value="Furto">Furto</option>
              <option value="Acidente">Acidente</option>
              <option value="Descarga">Descarga</option>
              <option value="Vandalismo">Vandalismo</option>
              <option value="Troca de poste">Troca de poste</option>
              <option value="Degrada√ß√£o / Infiltra√ß√£o">Degrada√ß√£o / Infiltra√ß√£o</option>
              <option value="Defeito Splitter">Defeito Splitter</option>
              <option value="Falha em atividade anterior">Falha em atividade anterior</option>
              <option value="Obra de terceiros">Obra de terceiros</option>
              <option value="Interperie">Interperie</option>
              <option value="Ataque de animais">Ataque de animais</option>
            </select>
          </div>
        </div>
        <div class="form-group full">
          <div>
            <label>Tratativa realizada</label>
            <textarea id="cto_defeito_tratativa" placeholder="Descreva a tratativa realizada"></textarea>
          </div>
        </div>
        <div class="form-group full">
          <div>
            <label>Material utilizado</label>
            <input type="text" id="cto_defeito_material" placeholder="Ex: Conector SC, Fibra √≥ptica, Splitter">
          </div>
        </div>
        <div class="actions">
          <button class="btn-generate" onclick="generateStamp('cto_defeito')">Gerar Carimbo</button>
          <button class="btn-clear" onclick="clearDynamic()">Limpar Formul√°rio</button>
        </div>
      </div>
    </div>

    <div id="output" class="output-section">
      <h3>Carimbo de Texto Gerado</h3>
      <div class="output-text" id="outputText"></div>
      <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
        <button class="btn-copy" onclick="copyToClipboard()">Copiar para √Årea de Transfer√™ncia</button>
        <button class="btn-copy" onclick="sendToWhatsApp()" style="background:#25d366;">Enviar via WhatsApp</button>
      </div>
      <div class="success-message" id="successMessage">Texto copiado para a √°rea de transfer√™ncia!</div>
    </div>
  </div>

  <script>
    const supervisorPhones = {
      "alexandre ilha": "(51) 99753-4576",
      "diego jaworski": "(51) 99670-7110",
      "diego richter": "(51) 99754-9214",
      "marcio mendes": "(51) 99589-2075",
      "mario pereira": "(51) 99837-8234",
      "rodrigo duarte": "(51) 99758-7793",
      "rodrigo rosa": "(51) 99840-6074"
    };

    function normalizeName(str) {
      return (str || "")
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .toLowerCase()
        .trim();
    }

    document.getElementById("carimbo_tipo").addEventListener("change", function() {
      const tipo = this.value;
      document.querySelectorAll(".dynamic-content").forEach(el => {
        el.classList.remove("active");
      });
      if (tipo) {
        const contentId = "content-" + tipo;
        const content = document.getElementById(contentId);
        if (content) content.classList.add("active");
      } else {
        document.getElementById("content-default").classList.add("active");
      }
      document.getElementById("output").classList.remove("active");
    });

    document.getElementById("supervisor").addEventListener("input", function() {
      const nome = this.value;
      const tel = supervisorPhones[normalizeName(nome)];
      if (tel) document.getElementById("supervisor_tel").value = tel;
    });

    function clearDynamic() {
      const tipo = document.getElementById("carimbo_tipo").value;
      if (!tipo) return;
      const contentId = "content-" + tipo;
      const content = document.getElementById(contentId);
      const inputs = content.querySelectorAll("input[type='text'], input[type='tel'], input[type='number'], input[type='time'], textarea, select");
      inputs.forEach(input => {
        if (input.readOnly) return;
        if (input.type === "radio" || input.type === "checkbox") {
          input.checked = false;
        } else {
          input.value = "";
        }
      });
    }

    function generateStamp(tipo) {
      const idOcorrencia = document.getElementById("id_ocorrencia").value;
      const supervisor = document.getElementById("supervisor").value;
      const supervisorTel = document.getElementById("supervisor_tel").value;
      const tecnico = document.getElementById("tecnico").value;
      const tecnicoTel = document.getElementById("tecnico_tel").value;
      const analistaCCR = document.getElementById("analista_ccr").value;
      let stamp = "";

      if (tipo === "acionamento") {
        const prevChegada = document.getElementById("acionamento_prev_chegada").value;
        const site = document.getElementById("acionamento_site").value;
        stamp = `1 ‚Äì ACIONAMENTO<br>
<br>
ID Ocorr√™ncia: ${idOcorrencia}<br>
SUPERVISOR: ${supervisor}<br>\nTelefone: ${supervisorTel}<br>
T√âCNICO: ${tecnico}<br>\nTelefone: ${tecnicoTel}<br>
Previs√£o de chegada ao SITE/ARO para medi√ß√µes: ${prevChegada}<br>\nNome SITE/ARO para medi√ß√µes: ${site}<br>
Analista CCR: ${analistaCCR}`.trim();
      } else if (tipo === "deslocamento") {
        const km = document.getElementById("deslocamento_km").value;
        const prevChegada = document.getElementById("deslocamento_prev_chegada").value;
        const obs = document.getElementById("deslocamento_obs").value;
        stamp = `2 ‚Äì DESLOCAMENTO AO PONTO DA FALHA<br>
<br>
ID Ocorr√™ncia: ${idOcorrencia}<br>
SUPERVISOR: ${supervisor}<br>\nTelefone: ${supervisorTel}<br>
T√âCNICO: ${tecnico}<br>\nTelefone: ${tecnicoTel}<br>
KM at√© o LOCAL da falha: ${km} km<br>\nPrevis√£o de chegada ao LOCAL da falha: ${prevChegada}<br>
Obs.: ${obs}<br>\nAnalista CCR: ${analistaCCR}`.trim();
      } else if (tipo === "recuperacao") {
        const causa = document.getElementById("recuperacao_causa").value;
        const prevTestes = document.getElementById("recuperacao_prev_testes").value;
        const endereco = document.getElementById("recuperacao_endereco").value;
        const cabo = document.getElementById("recuperacao_cabo").value;
        const tratativas = document.getElementById("recuperacao_tratativas").value;
        const obs = document.getElementById("recuperacao_obs").value;
        stamp = `3 ‚Äì RECUPERA√á√ÉO DA FALHA<br>
<br>
ID Ocorr√™ncia: ${idOcorrencia}<br>
SUPERVISOR: ${supervisor}<br>\nTelefone: ${supervisorTel}<br>
T√âCNICO: ${tecnico}<br>\nTelefone: ${tecnicoTel}<br>
Causa raiz: ${causa}<br>\nPrevis√£o para solicita√ß√£o de testes: ${prevTestes}<br>\nEndere√ßo da falha: ${endereco}<br>\nCabo/Capacidade/ARO: ${cabo}<br>
Tratativas realizadas: ${tratativas}<br>
Obs.: ${obs}<br>\nAnalista CCR: ${analistaCCR}`.trim();
      } else if (tipo === "certificacao") {
        const tratativa = document.getElementById("certificacao_tratativa").value;
        const causa = document.getElementById("certificacao_causa").value;
        const material = document.getElementById("certificacao_material").value;
        const foto = document.querySelector("input[name='certificacao_foto']:checked")?.value || "";
        stamp = `4 ‚Äì SOLICITA√á√ÉO DE CERTIFICA√á√ÉO<br>
<br>
ID Ocorr√™ncia: ${idOcorrencia}<br>
SUPERVISOR: ${supervisor}<br>\nTelefone: ${supervisorTel}<br>
T√âCNICO: ${tecnico}<br>\nTelefone: ${tecnicoTel}<br>
Tratativa realizada: ${tratativa}<br>\nCausa: ${causa}<br>\nMaterial utilizado: ${material}<br>\nFoto em anexo: ${foto}<br>\nAnalista CCR: ${analistaCCR}`.trim();
      } else if (tipo === "complementar") {
        const motivo = document.getElementById("complementar_motivo").value;
        const info = document.getElementById("complementar_info").value;
        const novaPrevisao = document.querySelector("input[name='nova_previsao']:checked")?.value || "";
        const previsao = document.getElementById("complementar_previsao").value;
        stamp = `3B ‚Äì COMPLEMENTAR<br>
<br>
ID Ocorr√™ncia: ${idOcorrencia}<br>
Motivo: ${motivo}<br>\nInforma√ß√£o: ${info}<br>\nNova previs√£o? ${novaPrevisao}<br>\nPrevis√£o: ${previsao}<br>\nAnalista CCR: ${analistaCCR}`.trim();
      } else if (tipo === "naofalha") {
        const motivo = document.getElementById("naofalha_motivo").value;
        const foto = document.querySelector("input[name='naofalha_foto']:checked")?.value || "";
        const gestor = document.getElementById("naofalha_gestor").value;
        stamp = `N√ÉO H√Å FALHA PARA REDE<br>
<br>
ID Ocorr√™ncia: ${idOcorrencia}<br>
SUPERVISOR: ${supervisor}<br>\nTelefone: ${supervisorTel}<br>
T√âCNICO: ${tecnico}<br>\nTelefone: ${tecnicoTel}<br>
Motivo da improdutiva: ${motivo}<br>\nFoto em anexo: ${foto}<br>\nCiente (Gestor VIVO Rede): ${gestor}<br>\nAnalista CCR: ${analistaCCR}`.trim();
      } else if (tipo === "transbordo") {
        const ta = document.getElementById("transbordota").value;
        const contrato = document.getElementById("transbordocontrato").value;
        const transbordo = document.getElementById("transbordooperadora").value;
        stamp = `TRANSBORDO<br>
<br>
ID Ocorr√™ncia: ${idOcorrencia}<br>
SUPERVISOR: ${supervisor}<br>\nTelefone: ${supervisorTel}<br>
T√âCNICO: ${tecnico}<br>\nTelefone: ${tecnicoTel}<br>
TA: ${ta}<br>\nCONTRATO: ${contrato}<br>\nTRANSBORDO: ${transbordo}<br>\nAnalista CCR: ${analistaCCR}`.trim();
      } else if (tipo === "prazo") {
        const cargo = document.getElementById("prazoreparocargo").value;
        const nomeTel = document.getElementById("prazoreparonometel").value;
        const sla = document.getElementById("prazoreparosla").value;
        const obs = document.getElementById("prazoreparoobs").value;
        stamp = `PRAZO DE REPARO<br>
<br>
ID Ocorr√™ncia: ${idOcorrencia}<br>
SUPERVISOR: ${supervisor}<br>\nTelefone: ${supervisorTel}<br>
T√âCNICO: ${tecnico}<br>\nTelefone: ${tecnicoTel}<br>
Cargo: ${cargo}<br>\nNome/Tel.: ${nomeTel}<br>\nSLA do evento: ${sla}<br>\nObs.: ${obs}<br>\nAnalista CCR: ${analistaCCR}`.trim();
      } else if (tipo === "cire") {
        const solicitante = document.getElementById("cire_solicitante").value;
        const contato = document.querySelector("input[name='cire_contato']:checked")?.value || "";
        const motivo = document.getElementById("cire_motivo").value;
        const info = document.getElementById("cire_info").value;
        const previsao = document.getElementById("cire_previsao").value;
        stamp = `INTERVEN√á√ÉO CIRE<br>
<br>
ID Ocorr√™ncia: ${idOcorrencia}<br>
Solicitante: ${solicitante}<br>\nMeio de contato: ${contato}<br>\nMotivo: ${motivo}<br>\nInforma√ß√£o: ${info}<br>\nPrevis√£o: ${previsao}<br>\nAnalista CCR: ${analistaCCR}`.trim();
      } else if (tipo === "escalonamento") {
        const cargo = document.getElementById("escalonamento_cargo").value;
        const nomeTel = document.getElementById("escalonamento_nome_tel").value;
        const sla = document.getElementById("escalonamento_sla").value;
        const obs = document.getElementById("escalonamento_obs").value;
        stamp = `ESCALONAMENTO SEM EQUIPE<br>
<br>
ID Ocorr√™ncia: ${idOcorrencia}<br>
Cargo: ${cargo}<br>\nNome/Tel.: ${nomeTel}<br>\nSLA do evento: ${sla}<br>\nObs.: ${obs}<br>\nAnalista CCR: ${analistaCCR}`.trim();
      } else if (tipo === "cto_defeito") {
        const site = document.getElementById("cto_defeito_site").value;
        const splitter = document.getElementById("cto_defeito_splitter").value;
        const caixa = document.getElementById("cto_defeito_caixa").value;
        const endereco = document.getElementById("cto_defeito_endereco").value;
        const causa = document.getElementById("cto_defeito_causa").value;
        const tratativa = document.getElementById("cto_defeito_tratativa").value;
        const material = document.getElementById("cto_defeito_material").value;
        stamp = `CTO COM DEFEITO<br>
<br>
ID Ocorr√™ncia: ${idOcorrencia}<br>
SUPERVISOR: ${supervisor}<br>\nTelefone: ${supervisorTel}<br>
T√âCNICO: ${tecnico}<br>\nTelefone: ${tecnicoTel}<br>
Nome SITE/ARO: ${site}<br>\nSplitter: ${splitter}<br>\nCaixa: ${caixa}<br>\nEndere√ßo: ${endereco}<br>\nCausa: ${causa}<br>
Tratativa realizada: ${tratativa}<br>\nMaterial utilizado: ${material}<br>
Analista CCR: ${analistaCCR}`.trim();
      }

      document.getElementById("outputText").textContent = stamp;
      document.getElementById("output").classList.add("active");
      document.getElementById("output").scrollIntoView({ behavior: "smooth" });
    }

    function copyToClipboard() {
      const outputText = document.getElementById("outputText").textContent;
      navigator.clipboard.writeText(outputText).then(() => {
        const msg = document.getElementById("successMessage");
        msg.classList.add("show");
        setTimeout(() => msg.classList.remove("show"), 3000);
      }).catch(err => alert("Erro ao copiar: " + err));
    }

    function sendToWhatsApp() {
      const outputText = document.getElementById("outputText").textContent;
      if (!outputText.trim()) {
        alert("Nenhum carimbo gerado. Gere o carimbo primeiro.");
        return;
      }
      const encodedText = encodeURIComponent(outputText);
      window.open("https://wa.me/?text=" + encodedText, "_blank");
    }
  </script>
</body>
</html>
